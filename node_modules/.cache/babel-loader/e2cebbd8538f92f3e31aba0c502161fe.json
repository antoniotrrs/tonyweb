{"ast":null,"code":"import { createVNode as _createVNode, Fragment as _Fragment, mergeProps as _mergeProps } from \"vue\"; // Styles\n\nimport \"./VNumberInput.css\"; // Components\n\nimport { VBtn } from \"../VBtn/index.js\";\nimport { VDefaultsProvider } from \"../VDefaultsProvider/index.js\";\nimport { VDivider } from \"../VDivider/index.js\";\nimport { makeVTextFieldProps, VTextField } from \"../VTextField/VTextField.js\"; // Composables\n\nimport { useHold } from \"./hold.js\";\nimport { useFocus } from \"../../composables/focus.js\";\nimport { useForm } from \"../../composables/form.js\";\nimport { forwardRefs } from \"../../composables/forwardRefs.js\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.js\"; // Utilities\n\nimport { computed, nextTick, onMounted, ref, shallowRef, watch, watchEffect } from 'vue';\nimport { clamp, genericComponent, omit, propsFactory, useRender } from \"../../util/index.js\"; // Types\n\nconst makeVNumberInputProps = propsFactory({\n  controlVariant: {\n    type: String,\n    default: 'default'\n  },\n  inset: Boolean,\n  hideInput: Boolean,\n  modelValue: {\n    type: Number,\n    default: null\n  },\n  min: {\n    type: Number,\n    default: Number.MIN_SAFE_INTEGER\n  },\n  max: {\n    type: Number,\n    default: Number.MAX_SAFE_INTEGER\n  },\n  step: {\n    type: Number,\n    default: 1\n  },\n  precision: {\n    type: Number,\n    default: 0\n  },\n  ...omit(makeVTextFieldProps(), ['modelValue', 'validationValue'])\n}, 'VNumberInput');\nexport const VNumberInput = genericComponent()({\n  name: 'VNumberInput',\n  props: { ...makeVNumberInputProps()\n  },\n  emits: {\n    'update:modelValue': val => true\n  },\n\n  setup(props, _ref) {\n    let {\n      slots\n    } = _ref;\n    const vTextFieldRef = ref();\n    const {\n      holdStart,\n      holdStop\n    } = useHold({\n      toggleUpDown\n    });\n    const form = useForm(props);\n    const controlsDisabled = computed(() => form.isDisabled.value || form.isReadonly.value);\n    const {\n      isFocused,\n      focus,\n      blur\n    } = useFocus(props);\n\n    function correctPrecision(val) {\n      let precision = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : props.precision;\n      const fixed = precision == null ? String(val) : val.toFixed(precision);\n      return isFocused.value ? Number(fixed).toString() // trim zeros\n      : fixed;\n    }\n\n    const model = useProxiedModel(props, 'modelValue', null, val => val ?? null, val => val == null ? val ?? null : clamp(Number(val), props.min, props.max));\n\n    const _inputText = shallowRef(null);\n\n    watchEffect(() => {\n      if (isFocused.value && !controlsDisabled.value) {// ignore external changes\n      } else if (model.value == null) {\n        _inputText.value = null;\n      } else if (!isNaN(model.value)) {\n        _inputText.value = correctPrecision(model.value);\n      }\n    });\n    const inputText = computed({\n      get: () => _inputText.value,\n\n      set(val) {\n        if (val === null || val === '') {\n          model.value = null;\n          _inputText.value = null;\n        } else if (!isNaN(Number(val)) && Number(val) <= props.max && Number(val) >= props.min) {\n          model.value = Number(val);\n          _inputText.value = val;\n        }\n      }\n\n    });\n    const canIncrease = computed(() => {\n      if (controlsDisabled.value) return false;\n      return (model.value ?? 0) + props.step <= props.max;\n    });\n    const canDecrease = computed(() => {\n      if (controlsDisabled.value) return false;\n      return (model.value ?? 0) - props.step >= props.min;\n    });\n    const controlVariant = computed(() => {\n      return props.hideInput ? 'stacked' : props.controlVariant;\n    });\n    const incrementIcon = computed(() => controlVariant.value === 'split' ? '$plus' : '$collapse');\n    const decrementIcon = computed(() => controlVariant.value === 'split' ? '$minus' : '$expand');\n    const controlNodeSize = computed(() => controlVariant.value === 'split' ? 'default' : 'small');\n    const controlNodeDefaultHeight = computed(() => controlVariant.value === 'stacked' ? 'auto' : '100%');\n    const incrementSlotProps = computed(() => ({\n      props: {\n        onClick: onControlClick,\n        onPointerup: onControlMouseup,\n        onPointerdown: onUpControlMousedown\n      }\n    }));\n    const decrementSlotProps = computed(() => ({\n      props: {\n        onClick: onControlClick,\n        onPointerup: onControlMouseup,\n        onPointerdown: onDownControlMousedown\n      }\n    }));\n    watch(() => props.precision, () => formatInputValue());\n    onMounted(() => {\n      clampModel();\n    });\n\n    function inferPrecision(value) {\n      if (value == null) return 0;\n      const str = value.toString();\n      const idx = str.indexOf('.');\n      return ~idx ? str.length - idx : 0;\n    }\n\n    function toggleUpDown() {\n      let increment = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      if (controlsDisabled.value) return;\n\n      if (model.value == null) {\n        inputText.value = correctPrecision(clamp(0, props.min, props.max));\n        return;\n      }\n\n      let inferredPrecision = Math.max(inferPrecision(model.value), inferPrecision(props.step));\n      if (props.precision != null) inferredPrecision = Math.max(inferredPrecision, props.precision);\n\n      if (increment) {\n        if (canIncrease.value) inputText.value = correctPrecision(model.value + props.step, inferredPrecision);\n      } else {\n        if (canDecrease.value) inputText.value = correctPrecision(model.value - props.step, inferredPrecision);\n      }\n    }\n\n    function onBeforeinput(e) {\n      if (!e.data) return;\n      const existingTxt = e.target?.value;\n      const selectionStart = e.target?.selectionStart;\n      const selectionEnd = e.target?.selectionEnd;\n      const potentialNewInputVal = existingTxt ? existingTxt.slice(0, selectionStart) + e.data + existingTxt.slice(selectionEnd) : e.data; // Only numbers, \"-\", \".\" are allowed\n      // AND \"-\", \".\" are allowed only once\n      // AND \"-\" is only allowed at the start\n\n      if (!/^-?(\\d+(\\.\\d*)?|(\\.\\d+)|\\d*|\\.)$/.test(potentialNewInputVal)) {\n        e.preventDefault();\n      }\n\n      if (props.precision == null) return; // Ignore decimal digits above precision limit\n\n      if (potentialNewInputVal.split('.')[1]?.length > props.precision) {\n        e.preventDefault();\n      } // Ignore decimal separator when precision = 0\n\n\n      if (props.precision === 0 && potentialNewInputVal.includes('.')) {\n        e.preventDefault();\n      }\n    }\n\n    async function onKeydown(e) {\n      if (['Enter', 'ArrowLeft', 'ArrowRight', 'Backspace', 'Delete', 'Tab'].includes(e.key) || e.ctrlKey) return;\n\n      if (['ArrowDown', 'ArrowUp'].includes(e.key)) {\n        e.preventDefault();\n        clampModel(); // _model is controlled, so need to wait until props['modelValue'] is updated\n\n        await nextTick();\n\n        if (e.key === 'ArrowDown') {\n          toggleUpDown(false);\n        } else {\n          toggleUpDown();\n        }\n      }\n    }\n\n    function onControlClick(e) {\n      e.stopPropagation();\n    }\n\n    function onControlMouseup(e) {\n      const el = e.currentTarget;\n      el?.releasePointerCapture(e.pointerId);\n      e.preventDefault();\n      e.stopPropagation();\n      holdStop();\n    }\n\n    function onUpControlMousedown(e) {\n      const el = e.currentTarget;\n      el?.setPointerCapture(e.pointerId);\n      e.preventDefault();\n      e.stopPropagation();\n      holdStart('up');\n    }\n\n    function onDownControlMousedown(e) {\n      const el = e.currentTarget;\n      el?.setPointerCapture(e.pointerId);\n      e.preventDefault();\n      e.stopPropagation();\n      holdStart('down');\n    }\n\n    function clampModel() {\n      if (controlsDisabled.value) return;\n      if (!vTextFieldRef.value) return;\n      const actualText = vTextFieldRef.value.value;\n\n      if (actualText && !isNaN(Number(actualText))) {\n        inputText.value = correctPrecision(clamp(Number(actualText), props.min, props.max));\n      } else {\n        inputText.value = null;\n      }\n    }\n\n    function formatInputValue() {\n      if (controlsDisabled.value) return;\n\n      if (model.value === null || isNaN(model.value)) {\n        inputText.value = null;\n        return;\n      }\n\n      inputText.value = props.precision == null ? String(model.value) : model.value.toFixed(props.precision);\n    }\n\n    function trimDecimalZeros() {\n      if (controlsDisabled.value) return;\n\n      if (model.value === null || isNaN(model.value)) {\n        inputText.value = null;\n        return;\n      }\n\n      inputText.value = model.value.toString();\n    }\n\n    function onFocus() {\n      focus();\n      trimDecimalZeros();\n    }\n\n    function onBlur() {\n      blur();\n      clampModel();\n    }\n\n    useRender(() => {\n      const {\n        modelValue: _,\n        ...textFieldProps\n      } = VTextField.filterProps(props);\n\n      function incrementControlNode() {\n        return !slots.increment ? _createVNode(VBtn, {\n          \"disabled\": !canIncrease.value,\n          \"flat\": true,\n          \"key\": \"increment-btn\",\n          \"height\": controlNodeDefaultHeight.value,\n          \"data-testid\": \"increment\",\n          \"aria-hidden\": \"true\",\n          \"icon\": incrementIcon.value,\n          \"onClick\": onControlClick,\n          \"onPointerup\": onControlMouseup,\n          \"onPointerdown\": onUpControlMousedown,\n          \"size\": controlNodeSize.value,\n          \"tabindex\": \"-1\"\n        }, null) : _createVNode(VDefaultsProvider, {\n          \"key\": \"increment-defaults\",\n          \"defaults\": {\n            VBtn: {\n              disabled: !canIncrease.value,\n              flat: true,\n              height: controlNodeDefaultHeight.value,\n              size: controlNodeSize.value,\n              icon: incrementIcon.value\n            }\n          }\n        }, {\n          default: () => [slots.increment(incrementSlotProps.value)]\n        });\n      }\n\n      function decrementControlNode() {\n        return !slots.decrement ? _createVNode(VBtn, {\n          \"disabled\": !canDecrease.value,\n          \"flat\": true,\n          \"key\": \"decrement-btn\",\n          \"height\": controlNodeDefaultHeight.value,\n          \"data-testid\": \"decrement\",\n          \"aria-hidden\": \"true\",\n          \"icon\": decrementIcon.value,\n          \"size\": controlNodeSize.value,\n          \"tabindex\": \"-1\",\n          \"onClick\": onControlClick,\n          \"onPointerup\": onControlMouseup,\n          \"onPointerdown\": onDownControlMousedown\n        }, null) : _createVNode(VDefaultsProvider, {\n          \"key\": \"decrement-defaults\",\n          \"defaults\": {\n            VBtn: {\n              disabled: !canDecrease.value,\n              flat: true,\n              height: controlNodeDefaultHeight.value,\n              size: controlNodeSize.value,\n              icon: decrementIcon.value\n            }\n          }\n        }, {\n          default: () => [slots.decrement(decrementSlotProps.value)]\n        });\n      }\n\n      function controlNode() {\n        return _createVNode(\"div\", {\n          \"class\": \"v-number-input__control\"\n        }, [decrementControlNode(), _createVNode(VDivider, {\n          \"vertical\": controlVariant.value !== 'stacked'\n        }, null), incrementControlNode()]);\n      }\n\n      function dividerNode() {\n        return !props.hideInput && !props.inset ? _createVNode(VDivider, {\n          \"vertical\": true\n        }, null) : undefined;\n      }\n\n      const appendInnerControl = controlVariant.value === 'split' ? _createVNode(\"div\", {\n        \"class\": \"v-number-input__control\"\n      }, [_createVNode(VDivider, {\n        \"vertical\": true\n      }, null), incrementControlNode()]) : props.reverse || controlVariant.value === 'hidden' ? undefined : _createVNode(_Fragment, null, [dividerNode(), controlNode()]);\n      const hasAppendInner = slots['append-inner'] || appendInnerControl;\n      const prependInnerControl = controlVariant.value === 'split' ? _createVNode(\"div\", {\n        \"class\": \"v-number-input__control\"\n      }, [decrementControlNode(), _createVNode(VDivider, {\n        \"vertical\": true\n      }, null)]) : props.reverse && controlVariant.value !== 'hidden' ? _createVNode(_Fragment, null, [controlNode(), dividerNode()]) : undefined;\n      const hasPrependInner = slots['prepend-inner'] || prependInnerControl;\n      return _createVNode(VTextField, _mergeProps({\n        \"ref\": vTextFieldRef,\n        \"modelValue\": inputText.value,\n        \"onUpdate:modelValue\": $event => inputText.value = $event,\n        \"validationValue\": model.value,\n        \"onBeforeinput\": onBeforeinput,\n        \"onFocus\": onFocus,\n        \"onBlur\": onBlur,\n        \"onKeydown\": onKeydown,\n        \"class\": ['v-number-input', {\n          'v-number-input--default': controlVariant.value === 'default',\n          'v-number-input--hide-input': props.hideInput,\n          'v-number-input--inset': props.inset,\n          'v-number-input--reverse': props.reverse,\n          'v-number-input--split': controlVariant.value === 'split',\n          'v-number-input--stacked': controlVariant.value === 'stacked'\n        }, props.class]\n      }, textFieldProps, {\n        \"style\": props.style,\n        \"inputmode\": \"decimal\"\n      }), { ...slots,\n        'append-inner': hasAppendInner ? function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _createVNode(_Fragment, null, [slots['append-inner']?.(...args), appendInnerControl]);\n        } : undefined,\n        'prepend-inner': hasPrependInner ? function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return _createVNode(_Fragment, null, [prependInnerControl, slots['prepend-inner']?.(...args)]);\n        } : undefined\n      });\n    });\n    return forwardRefs({}, vTextFieldRef);\n  }\n\n});","map":{"version":3,"mappings":"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","names":["VBtn","VDefaultsProvider","VDivider","makeVTextFieldProps","VTextField","useHold","useFocus","useForm","forwardRefs","useProxiedModel","computed","nextTick","onMounted","ref","shallowRef","watch","watchEffect","clamp","genericComponent","omit","propsFactory","useRender","makeVNumberInputProps","controlVariant","type","String","default","inset","Boolean","hideInput","modelValue","Number","min","MIN_SAFE_INTEGER","max","MAX_SAFE_INTEGER","step","precision","VNumberInput","name","props","emits","val","setup","_ref","slots","vTextFieldRef","holdStart","holdStop","toggleUpDown","form","controlsDisabled","isDisabled","value","isReadonly","isFocused","focus","blur","correctPrecision","fixed","toFixed","toString","model","_inputText","isNaN","inputText","get","set","canIncrease","canDecrease","incrementIcon","decrementIcon","controlNodeSize","controlNodeDefaultHeight","incrementSlotProps","onClick","onControlClick","onPointerup","onControlMouseup","onPointerdown","onUpControlMousedown","decrementSlotProps","onDownControlMousedown","formatInputValue","clampModel","inferPrecision","str","idx","indexOf","length","increment","inferredPrecision","Math","onBeforeinput","e","data","existingTxt","target","selectionStart","selectionEnd","potentialNewInputVal","slice","test","preventDefault","split","includes","onKeydown","key","ctrlKey","stopPropagation","el","currentTarget","releasePointerCapture","pointerId","setPointerCapture","actualText","trimDecimalZeros","onFocus","onBlur","_","textFieldProps","filterProps","incrementControlNode","_createVNode","disabled","flat","height","size","icon","decrementControlNode","decrement","controlNode","dividerNode","undefined","appendInnerControl","reverse","hasAppendInner","prependInnerControl","hasPrependInner","$event","class","style","args","_key","arguments","_key2"],"sources":["../../../src/components/VNumberInput/VNumberInput.tsx"],"sourcesContent":["// Styles\nimport './VNumberInput.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VDivider } from '@/components/VDivider'\nimport { makeVTextFieldProps, VTextField } from '@/components/VTextField/VTextField'\n\n// Composables\nimport { useHold } from './hold'\nimport { useFocus } from '@/composables/focus'\nimport { useForm } from '@/composables/form'\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, nextTick, onMounted, ref, shallowRef, watch, watchEffect } from 'vue'\nimport { clamp, genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VTextFieldSlots } from '@/components/VTextField/VTextField'\n\ntype ControlSlot = {\n  props: Record<string, unknown>\n}\n\ntype VNumberInputSlots = Omit<VTextFieldSlots, 'default'> & {\n  increment: ControlSlot\n  decrement: ControlSlot\n}\n\ntype ControlVariant = 'default' | 'stacked' | 'split' | 'hidden'\n\nconst makeVNumberInputProps = propsFactory({\n  controlVariant: {\n    type: String as PropType<ControlVariant>,\n    default: 'default',\n  },\n  inset: Boolean,\n  hideInput: Boolean,\n  modelValue: {\n    type: Number as PropType<number | null>,\n    default: null,\n  },\n  min: {\n    type: Number,\n    default: Number.MIN_SAFE_INTEGER,\n  },\n  max: {\n    type: Number,\n    default: Number.MAX_SAFE_INTEGER,\n  },\n  step: {\n    type: Number,\n    default: 1,\n  },\n  precision: {\n    type: Number as PropType<number | null>,\n    default: 0,\n  },\n\n  ...omit(makeVTextFieldProps(), ['modelValue', 'validationValue']),\n}, 'VNumberInput')\n\nexport const VNumberInput = genericComponent<VNumberInputSlots>()({\n  name: 'VNumberInput',\n\n  props: {\n    ...makeVNumberInputProps(),\n  },\n\n  emits: {\n    'update:modelValue': (val: number) => true,\n  },\n\n  setup (props, { slots }) {\n    const vTextFieldRef = ref<VTextField>()\n\n    const { holdStart, holdStop } = useHold({ toggleUpDown })\n    const form = useForm(props)\n    const controlsDisabled = computed(() => (\n      form.isDisabled.value || form.isReadonly.value\n    ))\n\n    const { isFocused, focus, blur } = useFocus(props)\n\n    function correctPrecision (val: number, precision = props.precision) {\n      const fixed = precision == null\n        ? String(val)\n        : val.toFixed(precision)\n      return isFocused.value\n        ? Number(fixed).toString() // trim zeros\n        : fixed\n    }\n\n    const model = useProxiedModel(props, 'modelValue', null,\n      val => val ?? null,\n      val => val == null\n        ? val ?? null\n        : clamp(Number(val), props.min, props.max)\n    )\n\n    const _inputText = shallowRef<string | null>(null)\n    watchEffect(() => {\n      if (isFocused.value && !controlsDisabled.value) {\n        // ignore external changes\n      } else if (model.value == null) {\n        _inputText.value = null\n      } else if (!isNaN(model.value)) {\n        _inputText.value = correctPrecision(model.value)\n      }\n    })\n    const inputText = computed<string | null>({\n      get: () => _inputText.value,\n      set (val) {\n        if (val === null || val === '') {\n          model.value = null\n          _inputText.value = null\n        } else if (!isNaN(Number(val)) && Number(val) <= props.max && Number(val) >= props.min) {\n          model.value = Number(val)\n          _inputText.value = val\n        }\n      },\n    })\n\n    const canIncrease = computed(() => {\n      if (controlsDisabled.value) return false\n      return (model.value ?? 0) as number + props.step <= props.max\n    })\n    const canDecrease = computed(() => {\n      if (controlsDisabled.value) return false\n      return (model.value ?? 0) as number - props.step >= props.min\n    })\n\n    const controlVariant = computed(() => {\n      return props.hideInput ? 'stacked' : props.controlVariant\n    })\n\n    const incrementIcon = computed(() => controlVariant.value === 'split' ? '$plus' : '$collapse')\n    const decrementIcon = computed(() => controlVariant.value === 'split' ? '$minus' : '$expand')\n    const controlNodeSize = computed(() => controlVariant.value === 'split' ? 'default' : 'small')\n    const controlNodeDefaultHeight = computed(() => controlVariant.value === 'stacked' ? 'auto' : '100%')\n\n    const incrementSlotProps = computed(() => ({\n      props: {\n        onClick: onControlClick,\n        onPointerup: onControlMouseup,\n        onPointerdown: onUpControlMousedown,\n      },\n    }))\n    const decrementSlotProps = computed(() => ({\n      props: {\n        onClick: onControlClick,\n        onPointerup: onControlMouseup,\n        onPointerdown: onDownControlMousedown,\n      },\n    }))\n\n    watch(() => props.precision, () => formatInputValue())\n\n    onMounted(() => {\n      clampModel()\n    })\n\n    function inferPrecision (value: number | null) {\n      if (value == null) return 0\n      const str = value.toString()\n      const idx = str.indexOf('.')\n      return ~idx ? str.length - idx : 0\n    }\n\n    function toggleUpDown (increment = true) {\n      if (controlsDisabled.value) return\n      if (model.value == null) {\n        inputText.value = correctPrecision(clamp(0, props.min, props.max))\n        return\n      }\n\n      let inferredPrecision = Math.max(inferPrecision(model.value), inferPrecision(props.step))\n      if (props.precision != null) inferredPrecision = Math.max(inferredPrecision, props.precision)\n      if (increment) {\n        if (canIncrease.value) inputText.value = correctPrecision(model.value + props.step, inferredPrecision)\n      } else {\n        if (canDecrease.value) inputText.value = correctPrecision(model.value - props.step, inferredPrecision)\n      }\n    }\n\n    function onBeforeinput (e: InputEvent) {\n      if (!e.data) return\n      const existingTxt = (e.target as HTMLInputElement)?.value\n      const selectionStart = (e.target as HTMLInputElement)?.selectionStart\n      const selectionEnd = (e.target as HTMLInputElement)?.selectionEnd\n      const potentialNewInputVal =\n        existingTxt\n          ? existingTxt.slice(0, selectionStart as number | undefined) + e.data + existingTxt.slice(selectionEnd as number | undefined)\n          : e.data\n      // Only numbers, \"-\", \".\" are allowed\n      // AND \"-\", \".\" are allowed only once\n      // AND \"-\" is only allowed at the start\n      if (!/^-?(\\d+(\\.\\d*)?|(\\.\\d+)|\\d*|\\.)$/.test(potentialNewInputVal)) {\n        e.preventDefault()\n      }\n\n      if (props.precision == null) return\n\n      // Ignore decimal digits above precision limit\n      if (potentialNewInputVal.split('.')[1]?.length > props.precision) {\n        e.preventDefault()\n      }\n      // Ignore decimal separator when precision = 0\n      if (props.precision === 0 && potentialNewInputVal.includes('.')) {\n        e.preventDefault()\n      }\n    }\n\n    async function onKeydown (e: KeyboardEvent) {\n      if (\n        ['Enter', 'ArrowLeft', 'ArrowRight', 'Backspace', 'Delete', 'Tab'].includes(e.key) ||\n        e.ctrlKey\n      ) return\n\n      if (['ArrowDown', 'ArrowUp'].includes(e.key)) {\n        e.preventDefault()\n        clampModel()\n        // _model is controlled, so need to wait until props['modelValue'] is updated\n        await nextTick()\n        if (e.key === 'ArrowDown') {\n          toggleUpDown(false)\n        } else {\n          toggleUpDown()\n        }\n      }\n    }\n\n    function onControlClick (e: MouseEvent) {\n      e.stopPropagation()\n    }\n\n    function onControlMouseup (e: PointerEvent) {\n      const el = e.currentTarget as HTMLElement\n      el?.releasePointerCapture(e.pointerId)\n      e.preventDefault()\n      e.stopPropagation()\n      holdStop()\n    }\n\n    function onUpControlMousedown (e: PointerEvent) {\n      const el = e.currentTarget as HTMLElement\n      el?.setPointerCapture(e.pointerId)\n      e.preventDefault()\n      e.stopPropagation()\n      holdStart('up')\n    }\n\n    function onDownControlMousedown (e: PointerEvent) {\n      const el = e.currentTarget as HTMLElement\n      el?.setPointerCapture(e.pointerId)\n      e.preventDefault()\n      e.stopPropagation()\n      holdStart('down')\n    }\n\n    function clampModel () {\n      if (controlsDisabled.value) return\n      if (!vTextFieldRef.value) return\n      const actualText = vTextFieldRef.value.value\n      if (actualText && !isNaN(Number(actualText))) {\n        inputText.value = correctPrecision(clamp(Number(actualText), props.min, props.max))\n      } else {\n        inputText.value = null\n      }\n    }\n\n    function formatInputValue () {\n      if (controlsDisabled.value) return\n      if (model.value === null || isNaN(model.value)) {\n        inputText.value = null\n        return\n      }\n      inputText.value = props.precision == null\n        ? String(model.value)\n        : model.value.toFixed(props.precision)\n    }\n\n    function trimDecimalZeros () {\n      if (controlsDisabled.value) return\n      if (model.value === null || isNaN(model.value)) {\n        inputText.value = null\n        return\n      }\n      inputText.value = model.value.toString()\n    }\n\n    function onFocus () {\n      focus()\n      trimDecimalZeros()\n    }\n\n    function onBlur () {\n      blur()\n      clampModel()\n    }\n\n    useRender(() => {\n      const { modelValue: _, ...textFieldProps } = VTextField.filterProps(props)\n\n      function incrementControlNode () {\n        return !slots.increment ? (\n          <VBtn\n            disabled={ !canIncrease.value }\n            flat\n            key=\"increment-btn\"\n            height={ controlNodeDefaultHeight.value }\n            data-testid=\"increment\"\n            aria-hidden=\"true\"\n            icon={ incrementIcon.value }\n            onClick={ onControlClick }\n            onPointerup={ onControlMouseup }\n            onPointerdown={ onUpControlMousedown }\n            size={ controlNodeSize.value }\n            tabindex=\"-1\"\n          />\n        ) : (\n          <VDefaultsProvider\n            key=\"increment-defaults\"\n            defaults={{\n              VBtn: {\n                disabled: !canIncrease.value,\n                flat: true,\n                height: controlNodeDefaultHeight.value,\n                size: controlNodeSize.value,\n                icon: incrementIcon.value,\n              },\n            }}\n          >\n            { slots.increment(incrementSlotProps.value) }\n          </VDefaultsProvider>\n        )\n      }\n\n      function decrementControlNode () {\n        return !slots.decrement ? (\n          <VBtn\n            disabled={ !canDecrease.value }\n            flat\n            key=\"decrement-btn\"\n            height={ controlNodeDefaultHeight.value }\n            data-testid=\"decrement\"\n            aria-hidden=\"true\"\n            icon={ decrementIcon.value }\n            size={ controlNodeSize.value }\n            tabindex=\"-1\"\n            onClick={ onControlClick }\n            onPointerup={ onControlMouseup }\n            onPointerdown={ onDownControlMousedown }\n          />\n        ) : (\n          <VDefaultsProvider\n            key=\"decrement-defaults\"\n            defaults={{\n              VBtn: {\n                disabled: !canDecrease.value,\n                flat: true,\n                height: controlNodeDefaultHeight.value,\n                size: controlNodeSize.value,\n                icon: decrementIcon.value,\n              },\n            }}\n          >\n            { slots.decrement(decrementSlotProps.value) }\n          </VDefaultsProvider>\n        )\n      }\n\n      function controlNode () {\n        return (\n          <div class=\"v-number-input__control\">\n            { decrementControlNode() }\n\n            <VDivider\n              vertical={ controlVariant.value !== 'stacked' }\n            />\n\n            { incrementControlNode() }\n          </div>\n        )\n      }\n\n      function dividerNode () {\n        return !props.hideInput && !props.inset ? <VDivider vertical /> : undefined\n      }\n\n      const appendInnerControl =\n        controlVariant.value === 'split'\n          ? (\n            <div class=\"v-number-input__control\">\n              <VDivider vertical />\n\n              { incrementControlNode() }\n            </div>\n          ) : (props.reverse || controlVariant.value === 'hidden'\n            ? undefined\n            : <>{ dividerNode() }{ controlNode() }</>)\n\n      const hasAppendInner = slots['append-inner'] || appendInnerControl\n\n      const prependInnerControl =\n        controlVariant.value === 'split'\n          ? (\n            <div class=\"v-number-input__control\">\n              { decrementControlNode() }\n\n              <VDivider vertical />\n            </div>\n          ) : (props.reverse && controlVariant.value !== 'hidden'\n            ? <>{ controlNode() }{ dividerNode() }</>\n            : undefined)\n\n      const hasPrependInner = slots['prepend-inner'] || prependInnerControl\n\n      return (\n        <VTextField\n          ref={ vTextFieldRef }\n          v-model={ inputText.value }\n          validationValue={ model.value }\n          onBeforeinput={ onBeforeinput }\n          onFocus={ onFocus }\n          onBlur={ onBlur }\n          onKeydown={ onKeydown }\n          class={[\n            'v-number-input',\n            {\n              'v-number-input--default': controlVariant.value === 'default',\n              'v-number-input--hide-input': props.hideInput,\n              'v-number-input--inset': props.inset,\n              'v-number-input--reverse': props.reverse,\n              'v-number-input--split': controlVariant.value === 'split',\n              'v-number-input--stacked': controlVariant.value === 'stacked',\n            },\n            props.class,\n          ]}\n          { ...textFieldProps }\n          style={ props.style }\n          inputmode=\"decimal\"\n        >\n          {{\n            ...slots,\n            'append-inner': hasAppendInner ? (...args) => (\n              <>\n                { slots['append-inner']?.(...args) }\n                { appendInnerControl }\n              </>\n            ) : undefined,\n            'prepend-inner': hasPrependInner ? (...args) => (\n              <>\n                { prependInnerControl }\n                { slots['prepend-inner']?.(...args) }\n              </>\n            ) : undefined,\n          }}\n        </VTextField>\n      )\n    })\n\n    return forwardRefs({}, vTextFieldRef)\n  },\n})\n\nexport type VNumberInput = InstanceType<typeof VNumberInput>\n"]},"metadata":{},"sourceType":"module"}