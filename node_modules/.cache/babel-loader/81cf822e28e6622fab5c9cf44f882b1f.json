{"ast":null,"code":"import _objectWithoutProperties from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _slicedToArray from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _typeof from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nvar _excluded = [\"modelValue\"],\n    _excluded2 = [\"class\"];\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport { Fragment as _Fragment, mergeProps as _mergeProps, createVNode as _createVNode } from \"vue\"; // Styles\n\nimport \"./VFileInput.css\"; // Components\n\nimport { VChip } from \"../VChip/index.js\";\nimport { VCounter } from \"../VCounter/index.js\";\nimport { VField } from \"../VField/index.js\";\nimport { makeVFieldProps } from \"../VField/VField.js\";\nimport { makeVInputProps, VInput } from \"../VInput/VInput.js\"; // Composables\n\nimport { useFocus } from \"../../composables/focus.js\";\nimport { forwardRefs } from \"../../composables/forwardRefs.js\";\nimport { useLocale } from \"../../composables/locale.js\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.js\"; // Utilities\n\nimport { computed, nextTick, ref, watch } from 'vue';\nimport { callEvent, filterInputAttrs, genericComponent, humanReadableFileSize, propsFactory, useRender, wrapInArray } from \"../../util/index.js\"; // Types\n\nexport var makeVFileInputProps = propsFactory(_objectSpread(_objectSpread({\n  chips: Boolean,\n  counter: Boolean,\n  counterSizeString: {\n    type: String,\n    default: '$vuetify.fileInput.counterSize'\n  },\n  counterString: {\n    type: String,\n    default: '$vuetify.fileInput.counter'\n  },\n  hideInput: Boolean,\n  multiple: Boolean,\n  showSize: {\n    type: [Boolean, Number, String],\n    default: false,\n    validator: function validator(v) {\n      return typeof v === 'boolean' || [1000, 1024].includes(Number(v));\n    }\n  }\n}, makeVInputProps({\n  prependIcon: '$file'\n})), {}, {\n  modelValue: {\n    type: [Array, Object],\n    default: function _default(props) {\n      return props.multiple ? [] : null;\n    },\n    validator: function validator(val) {\n      return wrapInArray(val).every(function (v) {\n        return v != null && _typeof(v) === 'object';\n      });\n    }\n  }\n}, makeVFieldProps({\n  clearable: true\n})), 'VFileInput');\nexport var VFileInput = genericComponent()({\n  name: 'VFileInput',\n  inheritAttrs: false,\n  props: makeVFileInputProps(),\n  emits: {\n    'click:control': function clickControl(e) {\n      return true;\n    },\n    'mousedown:control': function mousedownControl(e) {\n      return true;\n    },\n    'update:focused': function updateFocused(focused) {\n      return true;\n    },\n    'update:modelValue': function updateModelValue(files) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var attrs = _ref.attrs,\n        emit = _ref.emit,\n        slots = _ref.slots;\n\n    var _useLocale = useLocale(),\n        t = _useLocale.t;\n\n    var model = useProxiedModel(props, 'modelValue', props.modelValue, function (val) {\n      return wrapInArray(val);\n    }, function (val) {\n      return !props.multiple && Array.isArray(val) ? val[0] : val;\n    });\n\n    var _useFocus = useFocus(props),\n        isFocused = _useFocus.isFocused,\n        focus = _useFocus.focus,\n        blur = _useFocus.blur;\n\n    var base = computed(function () {\n      return typeof props.showSize !== 'boolean' ? props.showSize : undefined;\n    });\n    var totalBytes = computed(function () {\n      var _model$value;\n\n      return ((_model$value = model.value) !== null && _model$value !== void 0 ? _model$value : []).reduce(function (bytes, _ref2) {\n        var _ref2$size = _ref2.size,\n            size = _ref2$size === void 0 ? 0 : _ref2$size;\n        return bytes + size;\n      }, 0);\n    });\n    var totalBytesReadable = computed(function () {\n      return humanReadableFileSize(totalBytes.value, base.value);\n    });\n    var fileNames = computed(function () {\n      var _model$value2;\n\n      return ((_model$value2 = model.value) !== null && _model$value2 !== void 0 ? _model$value2 : []).map(function (file) {\n        var _file$name = file.name,\n            name = _file$name === void 0 ? '' : _file$name,\n            _file$size = file.size,\n            size = _file$size === void 0 ? 0 : _file$size;\n        return !props.showSize ? name : \"\".concat(name, \" (\").concat(humanReadableFileSize(size, base.value), \")\");\n      });\n    });\n    var counterValue = computed(function () {\n      var _model$value$length, _model$value3;\n\n      var fileCount = (_model$value$length = (_model$value3 = model.value) === null || _model$value3 === void 0 ? void 0 : _model$value3.length) !== null && _model$value$length !== void 0 ? _model$value$length : 0;\n      if (props.showSize) return t(props.counterSizeString, fileCount, totalBytesReadable.value);else return t(props.counterString, fileCount);\n    });\n    var vInputRef = ref();\n    var vFieldRef = ref();\n    var inputRef = ref();\n    var isActive = computed(function () {\n      return isFocused.value || props.active;\n    });\n    var isPlainOrUnderlined = computed(function () {\n      return ['plain', 'underlined'].includes(props.variant);\n    });\n\n    function onFocus() {\n      if (inputRef.value !== document.activeElement) {\n        var _inputRef$value;\n\n        (_inputRef$value = inputRef.value) === null || _inputRef$value === void 0 ? void 0 : _inputRef$value.focus();\n      }\n\n      if (!isFocused.value) focus();\n    }\n\n    function onClickPrepend(e) {\n      var _inputRef$value2;\n\n      (_inputRef$value2 = inputRef.value) === null || _inputRef$value2 === void 0 ? void 0 : _inputRef$value2.click();\n    }\n\n    function onControlMousedown(e) {\n      emit('mousedown:control', e);\n    }\n\n    function onControlClick(e) {\n      var _inputRef$value3;\n\n      (_inputRef$value3 = inputRef.value) === null || _inputRef$value3 === void 0 ? void 0 : _inputRef$value3.click();\n      emit('click:control', e);\n    }\n\n    function onClear(e) {\n      e.stopPropagation();\n      onFocus();\n      nextTick(function () {\n        model.value = [];\n        callEvent(props['onClick:clear'], e);\n      });\n    }\n\n    function onDragover(e) {\n      e.preventDefault();\n    }\n\n    function onDrop(e) {\n      var _e$dataTransfer$files;\n\n      e.preventDefault();\n      if (!e.dataTransfer) return;\n      model.value = _toConsumableArray((_e$dataTransfer$files = e.dataTransfer.files) !== null && _e$dataTransfer$files !== void 0 ? _e$dataTransfer$files : []);\n    }\n\n    watch(model, function (newValue) {\n      var hasModelReset = !Array.isArray(newValue) || !newValue.length;\n\n      if (hasModelReset && inputRef.value) {\n        inputRef.value.value = '';\n      }\n    });\n    useRender(function () {\n      var hasCounter = !!(slots.counter || props.counter);\n      var hasDetails = !!(hasCounter || slots.details);\n\n      var _filterInputAttrs = filterInputAttrs(attrs),\n          _filterInputAttrs2 = _slicedToArray(_filterInputAttrs, 2),\n          rootAttrs = _filterInputAttrs2[0],\n          inputAttrs = _filterInputAttrs2[1];\n\n      var _VInput$filterProps = VInput.filterProps(props),\n          _ = _VInput$filterProps.modelValue,\n          inputProps = _objectWithoutProperties(_VInput$filterProps, _excluded);\n\n      var fieldProps = VField.filterProps(props);\n      return _createVNode(VInput, _mergeProps({\n        \"ref\": vInputRef,\n        \"modelValue\": props.multiple ? model.value : model.value[0],\n        \"class\": ['v-file-input', {\n          'v-file-input--chips': !!props.chips,\n          'v-file-input--hide': props.hideInput,\n          'v-input--plain-underlined': isPlainOrUnderlined.value\n        }, props.class],\n        \"style\": props.style,\n        \"onClick:prepend\": onClickPrepend\n      }, rootAttrs, inputProps, {\n        \"centerAffix\": !isPlainOrUnderlined.value,\n        \"focused\": isFocused.value\n      }), _objectSpread(_objectSpread({}, slots), {}, {\n        default: function _default(_ref3) {\n          var id = _ref3.id,\n              isDisabled = _ref3.isDisabled,\n              isDirty = _ref3.isDirty,\n              isReadonly = _ref3.isReadonly,\n              isValid = _ref3.isValid;\n          return _createVNode(VField, _mergeProps({\n            \"ref\": vFieldRef,\n            \"prepend-icon\": props.prependIcon,\n            \"onMousedown\": onControlMousedown,\n            \"onClick\": onControlClick,\n            \"onClick:clear\": onClear,\n            \"onClick:prependInner\": props['onClick:prependInner'],\n            \"onClick:appendInner\": props['onClick:appendInner']\n          }, fieldProps, {\n            \"id\": id.value,\n            \"active\": isActive.value || isDirty.value,\n            \"dirty\": isDirty.value || props.dirty,\n            \"disabled\": isDisabled.value,\n            \"focused\": isFocused.value,\n            \"error\": isValid.value === false,\n            \"onDragover\": onDragover,\n            \"onDrop\": onDrop\n          }), _objectSpread(_objectSpread({}, slots), {}, {\n            default: function _default(_ref4) {\n              var _model$value4;\n\n              var _ref4$props = _ref4.props,\n                  fieldClass = _ref4$props.class,\n                  slotProps = _objectWithoutProperties(_ref4$props, _excluded2);\n\n              return _createVNode(_Fragment, null, [_createVNode(\"input\", _mergeProps({\n                \"ref\": inputRef,\n                \"type\": \"file\",\n                \"readonly\": isReadonly.value,\n                \"disabled\": isDisabled.value,\n                \"multiple\": props.multiple,\n                \"name\": props.name,\n                \"onClick\": function onClick(e) {\n                  e.stopPropagation();\n                  if (isReadonly.value) e.preventDefault();\n                  onFocus();\n                },\n                \"onChange\": function onChange(e) {\n                  var _target$files;\n\n                  if (!e.target) return;\n                  var target = e.target;\n                  model.value = _toConsumableArray((_target$files = target.files) !== null && _target$files !== void 0 ? _target$files : []);\n                },\n                \"onFocus\": onFocus,\n                \"onBlur\": blur\n              }, slotProps, inputAttrs), null), _createVNode(\"div\", {\n                \"class\": fieldClass\n              }, [!!((_model$value4 = model.value) !== null && _model$value4 !== void 0 && _model$value4.length) && !props.hideInput && (slots.selection ? slots.selection({\n                fileNames: fileNames.value,\n                totalBytes: totalBytes.value,\n                totalBytesReadable: totalBytesReadable.value\n              }) : props.chips ? fileNames.value.map(function (text) {\n                return _createVNode(VChip, {\n                  \"key\": text,\n                  \"size\": \"small\",\n                  \"text\": text\n                }, null);\n              }) : fileNames.value.join(', '))])]);\n            }\n          }));\n        },\n        details: hasDetails ? function (slotProps) {\n          var _slots$details, _model$value5;\n\n          return _createVNode(_Fragment, null, [(_slots$details = slots.details) === null || _slots$details === void 0 ? void 0 : _slots$details.call(slots, slotProps), hasCounter && _createVNode(_Fragment, null, [_createVNode(\"span\", null, null), _createVNode(VCounter, {\n            \"active\": !!((_model$value5 = model.value) !== null && _model$value5 !== void 0 && _model$value5.length),\n            \"value\": counterValue.value,\n            \"disabled\": props.disabled\n          }, slots.counter)])]);\n        } : undefined\n      }));\n    });\n    return forwardRefs({}, vInputRef, vFieldRef, inputRef);\n  }\n});","map":{"version":3,"mappings":"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","names":["VChip","VCounter","VField","makeVFieldProps","makeVInputProps","VInput","useFocus","forwardRefs","useLocale","useProxiedModel","computed","nextTick","ref","watch","callEvent","filterInputAttrs","genericComponent","humanReadableFileSize","propsFactory","useRender","wrapInArray","makeVFileInputProps","chips","Boolean","counter","counterSizeString","type","String","default","counterString","hideInput","multiple","showSize","Number","validator","v","includes","prependIcon","modelValue","Array","Object","props","val","every","clearable","VFileInput","name","inheritAttrs","emits","e","focused","files","setup","_ref","attrs","emit","slots","t","model","isArray","isFocused","focus","blur","base","undefined","totalBytes","value","reduce","bytes","_ref2","size","totalBytesReadable","fileNames","map","file","counterValue","fileCount","length","vInputRef","vFieldRef","inputRef","isActive","active","isPlainOrUnderlined","variant","onFocus","document","activeElement","onClickPrepend","click","onControlMousedown","onControlClick","onClear","stopPropagation","onDragover","preventDefault","onDrop","dataTransfer","newValue","hasModelReset","hasCounter","hasDetails","details","rootAttrs","inputAttrs","filterProps","_","inputProps","fieldProps","class","style","_ref3","id","isDisabled","isDirty","isReadonly","isValid","dirty","_ref4","fieldClass","slotProps","target","_createVNode","selection","text","join","disabled"],"sources":["../../../src/components/VFileInput/VFileInput.tsx"],"sourcesContent":["// Styles\nimport './VFileInput.sass'\n\n// Components\nimport { VChip } from '@/components/VChip'\nimport { VCounter } from '@/components/VCounter'\nimport { VField } from '@/components/VField'\nimport { makeVFieldProps } from '@/components/VField/VField'\nimport { makeVInputProps, VInput } from '@/components/VInput/VInput'\n\n// Composables\nimport { useFocus } from '@/composables/focus'\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, nextTick, ref, watch } from 'vue'\nimport {\n  callEvent,\n  filterInputAttrs,\n  genericComponent,\n  humanReadableFileSize,\n  propsFactory,\n  useRender,\n  wrapInArray,\n} from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VFieldSlots } from '@/components/VField/VField'\nimport type { VInputSlots } from '@/components/VInput/VInput'\n\nexport type VFileInputSlots = VInputSlots & VFieldSlots & {\n  counter: never\n  selection: {\n    fileNames: string[]\n    totalBytes: number\n    totalBytesReadable: string\n  }\n}\n\nexport const makeVFileInputProps = propsFactory({\n  chips: Boolean,\n  counter: Boolean,\n  counterSizeString: {\n    type: String,\n    default: '$vuetify.fileInput.counterSize',\n  },\n  counterString: {\n    type: String,\n    default: '$vuetify.fileInput.counter',\n  },\n  hideInput: Boolean,\n  multiple: Boolean,\n  showSize: {\n    type: [Boolean, Number, String] as PropType<boolean | 1000 | 1024>,\n    default: false,\n    validator: (v: boolean | number) => {\n      return (\n        typeof v === 'boolean' ||\n        [1000, 1024].includes(Number(v))\n      )\n    },\n  },\n\n  ...makeVInputProps({ prependIcon: '$file' }),\n\n  modelValue: {\n    type: [Array, Object] as PropType<File[] | File | null>,\n    default: (props: any) => props.multiple ? [] : null,\n    validator: (val: any) => {\n      return wrapInArray(val).every(v => v != null && typeof v === 'object')\n    },\n  },\n\n  ...makeVFieldProps({ clearable: true }),\n}, 'VFileInput')\n\nexport const VFileInput = genericComponent<VFileInputSlots>()({\n  name: 'VFileInput',\n\n  inheritAttrs: false,\n\n  props: makeVFileInputProps(),\n\n  emits: {\n    'click:control': (e: MouseEvent) => true,\n    'mousedown:control': (e: MouseEvent) => true,\n    'update:focused': (focused: boolean) => true,\n    'update:modelValue': (files: File | File[]) => true,\n  },\n\n  setup (props, { attrs, emit, slots }) {\n    const { t } = useLocale()\n    const model = useProxiedModel(\n      props,\n      'modelValue',\n      props.modelValue,\n      val => wrapInArray(val),\n      val => (!props.multiple && Array.isArray(val)) ? val[0] : val,\n    )\n    const { isFocused, focus, blur } = useFocus(props)\n    const base = computed(() => typeof props.showSize !== 'boolean' ? props.showSize : undefined)\n    const totalBytes = computed(() => (model.value ?? []).reduce((bytes, { size = 0 }) => bytes + size, 0))\n    const totalBytesReadable = computed(() => humanReadableFileSize(totalBytes.value, base.value))\n\n    const fileNames = computed(() => (model.value ?? []).map(file => {\n      const { name = '', size = 0 } = file\n\n      return !props.showSize\n        ? name\n        : `${name} (${humanReadableFileSize(size, base.value)})`\n    }))\n\n    const counterValue = computed(() => {\n      const fileCount = model.value?.length ?? 0\n      if (props.showSize) return t(props.counterSizeString, fileCount, totalBytesReadable.value)\n      else return t(props.counterString, fileCount)\n    })\n    const vInputRef = ref<VInput>()\n    const vFieldRef = ref<VInput>()\n    const inputRef = ref<HTMLInputElement>()\n    const isActive = computed(() => (\n      isFocused.value ||\n      props.active\n    ))\n    const isPlainOrUnderlined = computed(() => ['plain', 'underlined'].includes(props.variant))\n    function onFocus () {\n      if (inputRef.value !== document.activeElement) {\n        inputRef.value?.focus()\n      }\n\n      if (!isFocused.value) focus()\n    }\n    function onClickPrepend (e: MouseEvent) {\n      inputRef.value?.click()\n    }\n    function onControlMousedown (e: MouseEvent) {\n      emit('mousedown:control', e)\n    }\n    function onControlClick (e: MouseEvent) {\n      inputRef.value?.click()\n\n      emit('click:control', e)\n    }\n    function onClear (e: MouseEvent) {\n      e.stopPropagation()\n\n      onFocus()\n\n      nextTick(() => {\n        model.value = []\n\n        callEvent(props['onClick:clear'], e)\n      })\n    }\n    function onDragover (e: DragEvent) {\n      e.preventDefault()\n    }\n    function onDrop (e: DragEvent) {\n      e.preventDefault()\n\n      if (!e.dataTransfer) return\n\n      model.value = [...e.dataTransfer.files ?? []]\n    }\n\n    watch(model, newValue => {\n      const hasModelReset = !Array.isArray(newValue) || !newValue.length\n\n      if (hasModelReset && inputRef.value) {\n        inputRef.value.value = ''\n      }\n    })\n\n    useRender(() => {\n      const hasCounter = !!(slots.counter || props.counter)\n      const hasDetails = !!(hasCounter || slots.details)\n      const [rootAttrs, inputAttrs] = filterInputAttrs(attrs)\n      const { modelValue: _, ...inputProps } = VInput.filterProps(props)\n      const fieldProps = VField.filterProps(props)\n\n      return (\n        <VInput\n          ref={ vInputRef }\n          modelValue={ props.multiple ? model.value : model.value[0] }\n          class={[\n            'v-file-input',\n            {\n              'v-file-input--chips': !!props.chips,\n              'v-file-input--hide': props.hideInput,\n              'v-input--plain-underlined': isPlainOrUnderlined.value,\n            },\n            props.class,\n          ]}\n          style={ props.style }\n          onClick:prepend={ onClickPrepend }\n          { ...rootAttrs }\n          { ...inputProps }\n          centerAffix={ !isPlainOrUnderlined.value }\n          focused={ isFocused.value }\n        >\n          {{\n            ...slots,\n            default: ({\n              id,\n              isDisabled,\n              isDirty,\n              isReadonly,\n              isValid,\n            }) => (\n              <VField\n                ref={ vFieldRef }\n                prepend-icon={ props.prependIcon }\n                onMousedown={ onControlMousedown }\n                onClick={ onControlClick }\n                onClick:clear={ onClear }\n                onClick:prependInner={ props['onClick:prependInner'] }\n                onClick:appendInner={ props['onClick:appendInner'] }\n                { ...fieldProps }\n                id={ id.value }\n                active={ isActive.value || isDirty.value }\n                dirty={ isDirty.value || props.dirty }\n                disabled={ isDisabled.value }\n                focused={ isFocused.value }\n                error={ isValid.value === false }\n                onDragover={ onDragover }\n                onDrop={ onDrop }\n              >\n                {{\n                  ...slots,\n                  default: ({\n                    props: { class: fieldClass, ...slotProps },\n                  }) => (\n                    <>\n                      <input\n                        ref={ inputRef }\n                        type=\"file\"\n                        readonly={ isReadonly.value }\n                        disabled={ isDisabled.value }\n                        multiple={ props.multiple }\n                        name={ props.name }\n                        onClick={ e => {\n                          e.stopPropagation()\n\n                          if (isReadonly.value) e.preventDefault()\n\n                          onFocus()\n                        }}\n                        onChange={ e => {\n                          if (!e.target) return\n\n                          const target = e.target as HTMLInputElement\n                          model.value = [...target.files ?? []]\n                        }}\n                        onFocus={ onFocus }\n                        onBlur={ blur }\n                        { ...slotProps }\n                        { ...inputAttrs }\n                      />\n\n                      <div class={ fieldClass }>\n                        { !!model.value?.length && !props.hideInput && (\n                          slots.selection ? slots.selection({\n                            fileNames: fileNames.value,\n                            totalBytes: totalBytes.value,\n                            totalBytesReadable: totalBytesReadable.value,\n                          })\n                          : props.chips ? fileNames.value.map(text => (\n                            <VChip\n                              key={ text }\n                              size=\"small\"\n                              text={ text }\n                            />\n                          ))\n                          : fileNames.value.join(', ')\n                        )}\n                      </div>\n                    </>\n                  ),\n                }}\n              </VField>\n            ),\n            details: hasDetails ? slotProps => (\n              <>\n                { slots.details?.(slotProps) }\n\n                { hasCounter && (\n                  <>\n                    <span />\n\n                    <VCounter\n                      active={ !!model.value?.length }\n                      value={ counterValue.value }\n                      disabled={ props.disabled }\n                      v-slots:default={ slots.counter }\n                    />\n                  </>\n                )}\n              </>\n            ) : undefined,\n          }}\n        </VInput>\n      )\n    })\n\n    return forwardRefs({}, vInputRef, vFieldRef, inputRef)\n  },\n})\n\nexport type VFileInput = InstanceType<typeof VFileInput>\n"]},"metadata":{},"sourceType":"module"}