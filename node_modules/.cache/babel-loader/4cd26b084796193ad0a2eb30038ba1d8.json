{"ast":null,"code":"import _slicedToArray from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.fill.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { Fragment as _Fragment, createVNode as _createVNode, mergeProps as _mergeProps } from \"vue\"; // Styles\n\nimport \"./VOtpInput.css\"; // Components\n\nimport { makeVFieldProps, VField } from \"../VField/VField.js\";\nimport { VOverlay } from \"../VOverlay/VOverlay.js\";\nimport { VProgressCircular } from \"../VProgressCircular/VProgressCircular.js\"; // Composables\n\nimport { provideDefaults } from \"../../composables/defaults.js\";\nimport { makeDimensionProps, useDimension } from \"../../composables/dimensions.js\";\nimport { makeFocusProps, useFocus } from \"../../composables/focus.js\";\nimport { useLocale } from \"../../composables/locale.js\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.js\"; // Utilities\n\nimport { computed, nextTick, ref, watch } from 'vue';\nimport { filterInputAttrs, focusChild, genericComponent, pick, propsFactory, useRender } from \"../../util/index.js\"; // Types\n// Types\n\nexport var makeVOtpInputProps = propsFactory(_objectSpread(_objectSpread(_objectSpread({\n  autofocus: Boolean,\n  divider: String,\n  focusAll: Boolean,\n  label: {\n    type: String,\n    default: '$vuetify.input.otp'\n  },\n  length: {\n    type: [Number, String],\n    default: 6\n  },\n  modelValue: {\n    type: [Number, String],\n    default: undefined\n  },\n  placeholder: String,\n  type: {\n    type: String,\n    default: 'number'\n  }\n}, makeDimensionProps()), makeFocusProps()), pick(makeVFieldProps({\n  variant: 'outlined'\n}), ['baseColor', 'bgColor', 'class', 'color', 'disabled', 'error', 'loading', 'rounded', 'style', 'theme', 'variant'])), 'VOtpInput');\nexport var VOtpInput = genericComponent()({\n  name: 'VOtpInput',\n  props: makeVOtpInputProps(),\n  emits: {\n    finish: function finish(val) {\n      return true;\n    },\n    'update:focused': function updateFocused(val) {\n      return true;\n    },\n    'update:modelValue': function updateModelValue(val) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var attrs = _ref.attrs,\n        emit = _ref.emit,\n        slots = _ref.slots;\n\n    var _useDimension = useDimension(props),\n        dimensionStyles = _useDimension.dimensionStyles;\n\n    var _useFocus = useFocus(props),\n        isFocused = _useFocus.isFocused,\n        focus = _useFocus.focus,\n        blur = _useFocus.blur;\n\n    var model = useProxiedModel(props, 'modelValue', '', function (val) {\n      return val == null ? [] : String(val).split('');\n    }, function (val) {\n      return val.join('');\n    });\n\n    var _useLocale = useLocale(),\n        t = _useLocale.t;\n\n    var length = computed(function () {\n      return Number(props.length);\n    });\n    var fields = computed(function () {\n      return Array(length.value).fill(0);\n    });\n    var focusIndex = ref(-1);\n    var contentRef = ref();\n    var inputRef = ref([]);\n    var current = computed(function () {\n      return inputRef.value[focusIndex.value];\n    });\n\n    function onInput() {\n      // The maxlength attribute doesn't work for the number type input, so the text type is used.\n      // The following logic simulates the behavior of a number input.\n      if (isValidNumber(current.value.value)) {\n        current.value.value = '';\n        return;\n      }\n\n      var array = model.value.slice();\n      var value = current.value.value;\n      array[focusIndex.value] = value;\n      var target = null;\n\n      if (focusIndex.value > model.value.length) {\n        target = model.value.length + 1;\n      } else if (focusIndex.value + 1 !== length.value) {\n        target = 'next';\n      }\n\n      model.value = array;\n      if (target) focusChild(contentRef.value, target);\n    }\n\n    function onKeydown(e) {\n      var array = model.value.slice();\n      var index = focusIndex.value;\n      var target = null;\n      if (!['ArrowLeft', 'ArrowRight', 'Backspace', 'Delete'].includes(e.key)) return;\n      e.preventDefault();\n\n      if (e.key === 'ArrowLeft') {\n        target = 'prev';\n      } else if (e.key === 'ArrowRight') {\n        target = 'next';\n      } else if (['Backspace', 'Delete'].includes(e.key)) {\n        array[focusIndex.value] = '';\n        model.value = array;\n\n        if (focusIndex.value > 0 && e.key === 'Backspace') {\n          target = 'prev';\n        } else {\n          requestAnimationFrame(function () {\n            var _inputRef$value$index;\n\n            (_inputRef$value$index = inputRef.value[index]) === null || _inputRef$value$index === void 0 ? void 0 : _inputRef$value$index.select();\n          });\n        }\n      }\n\n      requestAnimationFrame(function () {\n        if (target != null) {\n          focusChild(contentRef.value, target);\n        }\n      });\n    }\n\n    function _onPaste(index, e) {\n      var _e$clipboardData$getD, _e$clipboardData, _inputRef$value;\n\n      e.preventDefault();\n      e.stopPropagation();\n      var clipboardText = (_e$clipboardData$getD = e === null || e === void 0 ? void 0 : (_e$clipboardData = e.clipboardData) === null || _e$clipboardData === void 0 ? void 0 : _e$clipboardData.getData('Text').slice(0, length.value)) !== null && _e$clipboardData$getD !== void 0 ? _e$clipboardData$getD : '';\n      if (isValidNumber(clipboardText)) return;\n      model.value = clipboardText.split('');\n      (_inputRef$value = inputRef.value) === null || _inputRef$value === void 0 ? void 0 : _inputRef$value[index].blur();\n    }\n\n    function reset() {\n      model.value = [];\n    }\n\n    function _onFocus(e, index) {\n      focus();\n      focusIndex.value = index;\n    }\n\n    function onBlur() {\n      blur();\n      focusIndex.value = -1;\n    }\n\n    function isValidNumber(value) {\n      return props.type === 'number' && /[^0-9]/g.test(value);\n    }\n\n    provideDefaults({\n      VField: {\n        color: computed(function () {\n          return props.color;\n        }),\n        bgColor: computed(function () {\n          return props.color;\n        }),\n        baseColor: computed(function () {\n          return props.baseColor;\n        }),\n        disabled: computed(function () {\n          return props.disabled;\n        }),\n        error: computed(function () {\n          return props.error;\n        }),\n        variant: computed(function () {\n          return props.variant;\n        })\n      }\n    }, {\n      scoped: true\n    });\n    watch(model, function (val) {\n      if (val.length === length.value) emit('finish', val.join(''));\n    }, {\n      deep: true\n    });\n    watch(focusIndex, function (val) {\n      if (val < 0) return;\n      nextTick(function () {\n        var _inputRef$value$val;\n\n        (_inputRef$value$val = inputRef.value[val]) === null || _inputRef$value$val === void 0 ? void 0 : _inputRef$value$val.select();\n      });\n    });\n    useRender(function () {\n      var _slots$default;\n\n      var _filterInputAttrs = filterInputAttrs(attrs),\n          _filterInputAttrs2 = _slicedToArray(_filterInputAttrs, 2),\n          rootAttrs = _filterInputAttrs2[0],\n          inputAttrs = _filterInputAttrs2[1];\n\n      return _createVNode(\"div\", _mergeProps({\n        \"class\": ['v-otp-input', {\n          'v-otp-input--divided': !!props.divider\n        }, props.class],\n        \"style\": [props.style]\n      }, rootAttrs), [_createVNode(\"div\", {\n        \"ref\": contentRef,\n        \"class\": \"v-otp-input__content\",\n        \"style\": [dimensionStyles.value]\n      }, [fields.value.map(function (_, i) {\n        return _createVNode(_Fragment, null, [props.divider && i !== 0 && _createVNode(\"span\", {\n          \"class\": \"v-otp-input__divider\"\n        }, [props.divider]), _createVNode(VField, {\n          \"focused\": isFocused.value && props.focusAll || focusIndex.value === i,\n          \"key\": i\n        }, _objectSpread(_objectSpread({}, slots), {}, {\n          loader: undefined,\n          default: function _default() {\n            return _createVNode(\"input\", {\n              \"ref\": function ref(val) {\n                return inputRef.value[i] = val;\n              },\n              \"aria-label\": t(props.label, i + 1),\n              \"autofocus\": i === 0 && props.autofocus,\n              \"autocomplete\": \"one-time-code\",\n              \"class\": ['v-otp-input__field'],\n              \"disabled\": props.disabled,\n              \"inputmode\": props.type === 'number' ? 'numeric' : 'text',\n              \"min\": props.type === 'number' ? 0 : undefined,\n              \"maxlength\": i === 0 ? length.value : '1',\n              \"placeholder\": props.placeholder,\n              \"type\": props.type === 'number' ? 'text' : props.type,\n              \"value\": model.value[i],\n              \"onInput\": onInput,\n              \"onFocus\": function onFocus(e) {\n                return _onFocus(e, i);\n              },\n              \"onBlur\": onBlur,\n              \"onKeydown\": onKeydown,\n              \"onPaste\": function onPaste(event) {\n                return _onPaste(i, event);\n              }\n            }, null);\n          }\n        }))]);\n      }), _createVNode(\"input\", _mergeProps({\n        \"class\": \"v-otp-input-input\",\n        \"type\": \"hidden\"\n      }, inputAttrs, {\n        \"value\": model.value.join('')\n      }), null), _createVNode(VOverlay, {\n        \"contained\": true,\n        \"content-class\": \"v-otp-input__loader\",\n        \"model-value\": !!props.loading,\n        \"persistent\": true\n      }, {\n        default: function _default() {\n          var _slots$loader, _slots$loader2;\n\n          return [(_slots$loader = (_slots$loader2 = slots.loader) === null || _slots$loader2 === void 0 ? void 0 : _slots$loader2.call(slots)) !== null && _slots$loader !== void 0 ? _slots$loader : _createVNode(VProgressCircular, {\n            \"color\": typeof props.loading === 'boolean' ? undefined : props.loading,\n            \"indeterminate\": true,\n            \"size\": \"24\",\n            \"width\": \"2\"\n          }, null)];\n        }\n      }), (_slots$default = slots.default) === null || _slots$default === void 0 ? void 0 : _slots$default.call(slots)])]);\n    });\n    return {\n      blur: function blur() {\n        var _inputRef$value2;\n\n        (_inputRef$value2 = inputRef.value) === null || _inputRef$value2 === void 0 ? void 0 : _inputRef$value2.some(function (input) {\n          return input.blur();\n        });\n      },\n      focus: function focus() {\n        var _inputRef$value3;\n\n        (_inputRef$value3 = inputRef.value) === null || _inputRef$value3 === void 0 ? void 0 : _inputRef$value3[0].focus();\n      },\n      reset: reset,\n      isFocused: isFocused\n    };\n  }\n});","map":{"version":3,"mappings":"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","names":["makeVFieldProps","VField","VOverlay","VProgressCircular","provideDefaults","makeDimensionProps","useDimension","makeFocusProps","useFocus","useLocale","useProxiedModel","computed","nextTick","ref","watch","filterInputAttrs","focusChild","genericComponent","pick","propsFactory","useRender","makeVOtpInputProps","autofocus","Boolean","divider","String","focusAll","label","type","default","length","Number","modelValue","undefined","placeholder","variant","VOtpInput","name","props","emits","finish","val","setup","_ref","attrs","emit","slots","dimensionStyles","isFocused","focus","blur","model","split","join","t","fields","Array","value","fill","focusIndex","contentRef","inputRef","current","onInput","isValidNumber","array","slice","target","onKeydown","e","index","includes","key","preventDefault","requestAnimationFrame","select","onPaste","stopPropagation","clipboardText","clipboardData","getData","reset","onFocus","onBlur","test","color","bgColor","baseColor","disabled","error","scoped","deep","rootAttrs","inputAttrs","class","style","map","_","i","_createVNode","loader","event","loading","some","input"],"sources":["../../../src/components/VOtpInput/VOtpInput.tsx"],"sourcesContent":["// Styles\nimport './VOtpInput.sass'\n\n// Components\nimport { makeVFieldProps, VField } from '@/components/VField/VField'\nimport { VOverlay } from '@/components/VOverlay/VOverlay'\nimport { VProgressCircular } from '@/components/VProgressCircular/VProgressCircular'\n\n// Composables\nimport { provideDefaults } from '@/composables/defaults'\nimport { makeDimensionProps, useDimension } from '@/composables/dimensions'\nimport { makeFocusProps, useFocus } from '@/composables/focus'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, nextTick, ref, watch } from 'vue'\nimport { filterInputAttrs, focusChild, genericComponent, pick, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\n// Types\nexport type VOtpInputSlots = {\n  default: never\n  loader: never\n}\n\nexport const makeVOtpInputProps = propsFactory({\n  autofocus: Boolean,\n  divider: String,\n  focusAll: Boolean,\n  label: {\n    type: String,\n    default: '$vuetify.input.otp',\n  },\n  length: {\n    type: [Number, String],\n    default: 6,\n  },\n  modelValue: {\n    type: [Number, String],\n    default: undefined,\n  },\n  placeholder: String,\n  type: {\n    type: String as PropType<'text' | 'password' | 'number'>,\n    default: 'number',\n  },\n\n  ...makeDimensionProps(),\n  ...makeFocusProps(),\n  ...pick(makeVFieldProps({\n    variant: 'outlined' as const,\n  }), [\n    'baseColor',\n    'bgColor',\n    'class',\n    'color',\n    'disabled',\n    'error',\n    'loading',\n    'rounded',\n    'style',\n    'theme',\n    'variant',\n  ]),\n}, 'VOtpInput')\n\nexport const VOtpInput = genericComponent<VOtpInputSlots>()({\n  name: 'VOtpInput',\n\n  props: makeVOtpInputProps(),\n\n  emits: {\n    finish: (val: string) => true,\n    'update:focused': (val: boolean) => true,\n    'update:modelValue': (val: string) => true,\n  },\n\n  setup (props, { attrs, emit, slots }) {\n    const { dimensionStyles } = useDimension(props)\n    const { isFocused, focus, blur } = useFocus(props)\n    const model = useProxiedModel(\n      props,\n      'modelValue',\n      '',\n      val => val == null ? [] : String(val).split(''),\n      val => val.join('')\n    )\n    const { t } = useLocale()\n\n    const length = computed(() => Number(props.length))\n    const fields = computed(() => Array(length.value).fill(0))\n    const focusIndex = ref(-1)\n    const contentRef = ref<HTMLElement>()\n    const inputRef = ref<HTMLInputElement[]>([])\n    const current = computed(() => inputRef.value[focusIndex.value])\n\n    function onInput () {\n      // The maxlength attribute doesn't work for the number type input, so the text type is used.\n      // The following logic simulates the behavior of a number input.\n      if (isValidNumber(current.value.value)) {\n        current.value.value = ''\n        return\n      }\n\n      const array = model.value.slice()\n      const value = current.value.value\n\n      array[focusIndex.value] = value\n\n      let target: any = null\n\n      if (focusIndex.value > model.value.length) {\n        target = model.value.length + 1\n      } else if (focusIndex.value + 1 !== length.value) {\n        target = 'next'\n      }\n\n      model.value = array\n\n      if (target) focusChild(contentRef.value!, target)\n    }\n\n    function onKeydown (e: KeyboardEvent) {\n      const array = model.value.slice()\n      const index = focusIndex.value\n      let target: 'next' | 'prev' | 'first' | 'last' | number | null = null\n\n      if (![\n        'ArrowLeft',\n        'ArrowRight',\n        'Backspace',\n        'Delete',\n      ].includes(e.key)) return\n\n      e.preventDefault()\n\n      if (e.key === 'ArrowLeft') {\n        target = 'prev'\n      } else if (e.key === 'ArrowRight') {\n        target = 'next'\n      } else if (['Backspace', 'Delete'].includes(e.key)) {\n        array[focusIndex.value] = ''\n\n        model.value = array\n\n        if (focusIndex.value > 0 && e.key === 'Backspace') {\n          target = 'prev'\n        } else {\n          requestAnimationFrame(() => {\n            inputRef.value[index]?.select()\n          })\n        }\n      }\n\n      requestAnimationFrame(() => {\n        if (target != null) {\n          focusChild(contentRef.value!, target)\n        }\n      })\n    }\n\n    function onPaste (index: number, e: ClipboardEvent) {\n      e.preventDefault()\n      e.stopPropagation()\n\n      const clipboardText = e?.clipboardData?.getData('Text').slice(0, length.value) ?? ''\n\n      if (isValidNumber(clipboardText)) return\n\n      model.value = clipboardText.split('')\n\n      inputRef.value?.[index].blur()\n    }\n\n    function reset () {\n      model.value = []\n    }\n\n    function onFocus (e: FocusEvent, index: number) {\n      focus()\n\n      focusIndex.value = index\n    }\n\n    function onBlur () {\n      blur()\n\n      focusIndex.value = -1\n    }\n\n    function isValidNumber (value: string) {\n      return props.type === 'number' && /[^0-9]/g.test(value)\n    }\n\n    provideDefaults({\n      VField: {\n        color: computed(() => props.color),\n        bgColor: computed(() => props.color),\n        baseColor: computed(() => props.baseColor),\n        disabled: computed(() => props.disabled),\n        error: computed(() => props.error),\n        variant: computed(() => props.variant),\n      },\n    }, { scoped: true })\n\n    watch(model, val => {\n      if (val.length === length.value) emit('finish', val.join(''))\n    }, { deep: true })\n\n    watch(focusIndex, val => {\n      if (val < 0) return\n\n      nextTick(() => {\n        inputRef.value[val]?.select()\n      })\n    })\n\n    useRender(() => {\n      const [rootAttrs, inputAttrs] = filterInputAttrs(attrs)\n\n      return (\n        <div\n          class={[\n            'v-otp-input',\n            {\n              'v-otp-input--divided': !!props.divider,\n            },\n            props.class,\n          ]}\n          style={[\n            props.style,\n          ]}\n          { ...rootAttrs }\n        >\n          <div\n            ref={ contentRef }\n            class=\"v-otp-input__content\"\n            style={[\n              dimensionStyles.value,\n            ]}\n          >\n            { fields.value.map((_, i) => (\n              <>\n                { props.divider && i !== 0 && (\n                  <span class=\"v-otp-input__divider\">{ props.divider }</span>\n                )}\n\n                <VField\n                  focused={ (isFocused.value && props.focusAll) || focusIndex.value === i }\n                  key={ i }\n                >\n                  {{\n                    ...slots,\n                    loader: undefined,\n                    default: () => {\n                      return (\n                        <input\n                          ref={ val => inputRef.value[i] = val as HTMLInputElement }\n                          aria-label={ t(props.label, i + 1) }\n                          autofocus={ i === 0 && props.autofocus }\n                          autocomplete=\"one-time-code\"\n                          class={[\n                            'v-otp-input__field',\n                          ]}\n                          disabled={ props.disabled }\n                          inputmode={ props.type === 'number' ? 'numeric' : 'text' }\n                          min={ props.type === 'number' ? 0 : undefined }\n                          maxlength={ i === 0 ? length.value : '1' }\n                          placeholder={ props.placeholder }\n                          type={ props.type === 'number' ? 'text' : props.type }\n                          value={ model.value[i] }\n                          onInput={ onInput }\n                          onFocus={ e => onFocus(e, i) }\n                          onBlur={ onBlur }\n                          onKeydown={ onKeydown }\n                          onPaste={ event => onPaste(i, event) }\n                        />\n                      )\n                    },\n                  }}\n                </VField>\n              </>\n            ))}\n\n            <input\n              class=\"v-otp-input-input\"\n              type=\"hidden\"\n              { ...inputAttrs }\n              value={ model.value.join('') }\n            />\n\n            <VOverlay\n              contained\n              content-class=\"v-otp-input__loader\"\n              model-value={ !!props.loading }\n              persistent\n            >\n              { slots.loader?.() ?? (\n                <VProgressCircular\n                  color={ typeof props.loading === 'boolean' ? undefined : props.loading }\n                  indeterminate\n                  size=\"24\"\n                  width=\"2\"\n                />\n              )}\n            </VOverlay>\n\n            { slots.default?.() }\n          </div>\n        </div>\n      )\n    })\n\n    return {\n      blur: () => {\n        inputRef.value?.some(input => input.blur())\n      },\n      focus: () => {\n        inputRef.value?.[0].focus()\n      },\n      reset,\n      isFocused,\n    }\n  },\n})\n\nexport type VOtpInput = InstanceType<typeof VOtpInput>\n"]},"metadata":{},"sourceType":"module"}