{"ast":null,"code":"import _slicedToArray from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\n// Composables\nimport { useLocale } from \"../../../composables/index.js\";\nimport { useProxiedModel } from \"../../../composables/proxiedModel.js\"; // Utilities\n\nimport { computed, inject, provide, toRef } from 'vue';\nimport { getObjectValueByPath, isEmpty, propsFactory } from \"../../../util/index.js\"; // Types\n\nexport var makeDataTableSortProps = propsFactory({\n  sortBy: {\n    type: Array,\n    default: function _default() {\n      return [];\n    }\n  },\n  customKeySort: Object,\n  multiSort: Boolean,\n  mustSort: Boolean\n}, 'DataTable-sort');\nvar VDataTableSortSymbol = Symbol.for('vuetify:data-table-sort');\nexport function createSort(props) {\n  var sortBy = useProxiedModel(props, 'sortBy');\n  var mustSort = toRef(props, 'mustSort');\n  var multiSort = toRef(props, 'multiSort');\n  return {\n    sortBy: sortBy,\n    mustSort: mustSort,\n    multiSort: multiSort\n  };\n}\nexport function provideSort(options) {\n  var sortBy = options.sortBy,\n      mustSort = options.mustSort,\n      multiSort = options.multiSort,\n      page = options.page;\n\n  var toggleSort = function toggleSort(column) {\n    var _sortBy$value$map;\n\n    if (column.key == null) return;\n    var newSortBy = (_sortBy$value$map = sortBy.value.map(function (x) {\n      return _objectSpread({}, x);\n    })) !== null && _sortBy$value$map !== void 0 ? _sortBy$value$map : [];\n    var item = newSortBy.find(function (x) {\n      return x.key === column.key;\n    });\n\n    if (!item) {\n      if (multiSort.value) {\n        newSortBy.push({\n          key: column.key,\n          order: 'asc'\n        });\n      } else {\n        newSortBy = [{\n          key: column.key,\n          order: 'asc'\n        }];\n      }\n    } else if (item.order === 'desc') {\n      if (mustSort.value && newSortBy.length === 1) {\n        item.order = 'asc';\n      } else {\n        newSortBy = newSortBy.filter(function (x) {\n          return x.key !== column.key;\n        });\n      }\n    } else {\n      item.order = 'desc';\n    }\n\n    sortBy.value = newSortBy;\n    if (page) page.value = 1;\n  };\n\n  function isSorted(column) {\n    return !!sortBy.value.find(function (item) {\n      return item.key === column.key;\n    });\n  }\n\n  var data = {\n    sortBy: sortBy,\n    toggleSort: toggleSort,\n    isSorted: isSorted\n  };\n  provide(VDataTableSortSymbol, data);\n  return data;\n}\nexport function useSort() {\n  var data = inject(VDataTableSortSymbol);\n  if (!data) throw new Error('Missing sort!');\n  return data;\n} // TODO: abstract into project composable\n\nexport function useSortedItems(props, items, sortBy, options) {\n  var locale = useLocale();\n  var sortedItems = computed(function () {\n    var _options$sortFunction, _options$sortRawFunct;\n\n    if (!sortBy.value.length) return items.value;\n    return sortItems(items.value, sortBy.value, locale.current.value, {\n      transform: options === null || options === void 0 ? void 0 : options.transform,\n      sortFunctions: _objectSpread(_objectSpread({}, props.customKeySort), options === null || options === void 0 ? void 0 : (_options$sortFunction = options.sortFunctions) === null || _options$sortFunction === void 0 ? void 0 : _options$sortFunction.value),\n      sortRawFunctions: options === null || options === void 0 ? void 0 : (_options$sortRawFunct = options.sortRawFunctions) === null || _options$sortRawFunct === void 0 ? void 0 : _options$sortRawFunct.value\n    });\n  });\n  return {\n    sortedItems: sortedItems\n  };\n}\nexport function sortItems(items, sortByItems, locale, options) {\n  var stringCollator = new Intl.Collator(locale, {\n    sensitivity: 'accent',\n    usage: 'sort'\n  });\n  var transformedItems = items.map(function (item) {\n    return [item, options !== null && options !== void 0 && options.transform ? options.transform(item) : item];\n  });\n  return transformedItems.sort(function (a, b) {\n    for (var i = 0; i < sortByItems.length; i++) {\n      var _sortByItems$i$order, _options$sortRawFunct2, _options$sortFunction2;\n\n      var hasCustomResult = false;\n      var sortKey = sortByItems[i].key;\n      var sortOrder = (_sortByItems$i$order = sortByItems[i].order) !== null && _sortByItems$i$order !== void 0 ? _sortByItems$i$order : 'asc';\n      if (sortOrder === false) continue;\n      var sortA = getObjectValueByPath(a[1], sortKey);\n      var sortB = getObjectValueByPath(b[1], sortKey);\n      var sortARaw = a[0].raw;\n      var sortBRaw = b[0].raw;\n\n      if (sortOrder === 'desc') {\n        var _ref2 = [sortB, sortA];\n        sortA = _ref2[0];\n        sortB = _ref2[1];\n        var _ref3 = [sortBRaw, sortARaw];\n        sortARaw = _ref3[0];\n        sortBRaw = _ref3[1];\n      }\n\n      if (options !== null && options !== void 0 && (_options$sortRawFunct2 = options.sortRawFunctions) !== null && _options$sortRawFunct2 !== void 0 && _options$sortRawFunct2[sortKey]) {\n        var customResult = options.sortRawFunctions[sortKey](sortARaw, sortBRaw);\n        if (customResult == null) continue;\n        hasCustomResult = true;\n        if (customResult) return customResult;\n      }\n\n      if (options !== null && options !== void 0 && (_options$sortFunction2 = options.sortFunctions) !== null && _options$sortFunction2 !== void 0 && _options$sortFunction2[sortKey]) {\n        var _customResult = options.sortFunctions[sortKey](sortA, sortB);\n\n        if (_customResult == null) continue;\n        hasCustomResult = true;\n        if (_customResult) return _customResult;\n      }\n\n      if (hasCustomResult) continue; // Dates should be compared numerically\n\n      if (sortA instanceof Date && sortB instanceof Date) {\n        return sortA.getTime() - sortB.getTime();\n      }\n\n      var _map = [sortA, sortB].map(function (s) {\n        return s != null ? s.toString().toLocaleLowerCase() : s;\n      });\n\n      var _map2 = _slicedToArray(_map, 2);\n\n      sortA = _map2[0];\n      sortB = _map2[1];\n\n      if (sortA !== sortB) {\n        if (isEmpty(sortA) && isEmpty(sortB)) return 0;\n        if (isEmpty(sortA)) return -1;\n        if (isEmpty(sortB)) return 1;\n        if (!isNaN(sortA) && !isNaN(sortB)) return Number(sortA) - Number(sortB);\n        return stringCollator.compare(sortA, sortB);\n      }\n    }\n\n    return 0;\n  }).map(function (_ref) {\n    var _ref4 = _slicedToArray(_ref, 1),\n        item = _ref4[0];\n\n    return item;\n  });\n}","map":{"version":3,"mappings":"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","names":["useLocale","useProxiedModel","computed","inject","provide","toRef","getObjectValueByPath","isEmpty","propsFactory","makeDataTableSortProps","sortBy","type","Array","default","customKeySort","Object","multiSort","Boolean","mustSort","VDataTableSortSymbol","Symbol","for","createSort","props","provideSort","options","page","toggleSort","column","key","newSortBy","value","map","x","item","find","push","order","length","filter","isSorted","data","useSort","Error","useSortedItems","items","locale","sortedItems","sortItems","current","transform","sortFunctions","sortRawFunctions","sortByItems","stringCollator","Intl","Collator","sensitivity","usage","transformedItems","sort","a","b","i","hasCustomResult","sortKey","sortOrder","sortA","sortB","sortARaw","raw","sortBRaw","customResult","Date","getTime","s","toString","toLocaleLowerCase","isNaN","Number","compare","_ref"],"sources":["../../../../src/components/VDataTable/composables/sort.ts"],"sourcesContent":["// Composables\nimport { useLocale } from '@/composables'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, inject, provide, toRef } from 'vue'\nimport { getObjectValueByPath, isEmpty, propsFactory } from '@/util'\n\n// Types\nimport type { InjectionKey, PropType, Ref } from 'vue'\nimport type { DataTableCompareFunction, InternalDataTableHeader } from '../types'\nimport type { InternalItem } from '@/composables/filter'\n\nexport const makeDataTableSortProps = propsFactory({\n  sortBy: {\n    type: Array as PropType<readonly SortItem[]>,\n    default: () => ([]),\n  },\n  customKeySort: Object as PropType<Record<string, DataTableCompareFunction>>,\n  multiSort: Boolean,\n  mustSort: Boolean,\n}, 'DataTable-sort')\n\nconst VDataTableSortSymbol: InjectionKey<{\n  sortBy: Ref<readonly SortItem[]>\n  toggleSort: (column: InternalDataTableHeader) => void\n  isSorted: (column: InternalDataTableHeader) => boolean\n}> = Symbol.for('vuetify:data-table-sort')\n\nexport type SortItem = { key: string, order?: boolean | 'asc' | 'desc' }\n\ntype SortProps = {\n  sortBy: readonly SortItem[]\n  'onUpdate:sortBy': ((value: any) => void) | undefined\n  mustSort: boolean\n  multiSort: boolean\n}\n\nexport function createSort (props: SortProps) {\n  const sortBy = useProxiedModel(props, 'sortBy')\n  const mustSort = toRef(props, 'mustSort')\n  const multiSort = toRef(props, 'multiSort')\n\n  return { sortBy, mustSort, multiSort }\n}\n\nexport function provideSort (options: {\n  sortBy: Ref<readonly SortItem[]>\n  mustSort: Ref<boolean>\n  multiSort: Ref<boolean>\n  page?: Ref<number>\n}) {\n  const { sortBy, mustSort, multiSort, page } = options\n\n  const toggleSort = (column: InternalDataTableHeader) => {\n    if (column.key == null) return\n\n    let newSortBy = sortBy.value.map(x => ({ ...x })) ?? []\n    const item = newSortBy.find(x => x.key === column.key)\n\n    if (!item) {\n      if (multiSort.value) {\n        newSortBy.push({ key: column.key, order: 'asc' })\n      } else {\n        newSortBy = [{ key: column.key, order: 'asc' }]\n      }\n    } else if (item.order === 'desc') {\n      if (mustSort.value && newSortBy.length === 1) {\n        item.order = 'asc'\n      } else {\n        newSortBy = newSortBy.filter(x => x.key !== column.key)\n      }\n    } else {\n      item.order = 'desc'\n    }\n\n    sortBy.value = newSortBy\n    if (page) page.value = 1\n  }\n\n  function isSorted (column: InternalDataTableHeader) {\n    return !!sortBy.value.find(item => item.key === column.key)\n  }\n\n  const data = { sortBy, toggleSort, isSorted }\n\n  provide(VDataTableSortSymbol, data)\n\n  return data\n}\n\nexport function useSort () {\n  const data = inject(VDataTableSortSymbol)\n\n  if (!data) throw new Error('Missing sort!')\n\n  return data\n}\n\n// TODO: abstract into project composable\nexport function useSortedItems<T extends InternalItem> (\n  props: {\n    customKeySort: Record<string, DataTableCompareFunction> | undefined\n  },\n  items: Ref<T[]>,\n  sortBy: Ref<readonly SortItem[]>,\n  options?: {\n    transform?: (item: T) => {}\n    sortFunctions?: Ref<Record<string, DataTableCompareFunction> | undefined>\n    sortRawFunctions?: Ref<Record<string, DataTableCompareFunction> | undefined>\n  },\n) {\n  const locale = useLocale()\n  const sortedItems = computed(() => {\n    if (!sortBy.value.length) return items.value\n\n    return sortItems(items.value, sortBy.value, locale.current.value, {\n      transform: options?.transform,\n      sortFunctions: {\n        ...props.customKeySort,\n        ...options?.sortFunctions?.value,\n      },\n      sortRawFunctions: options?.sortRawFunctions?.value,\n    })\n  })\n\n  return { sortedItems }\n}\n\nexport function sortItems<T extends InternalItem> (\n  items: T[],\n  sortByItems: readonly SortItem[],\n  locale: string,\n  options?: {\n    transform?: (item: T) => Record<string, any>\n    sortFunctions?: Record<string, DataTableCompareFunction>\n    sortRawFunctions?: Record<string, DataTableCompareFunction>\n  },\n): T[] {\n  const stringCollator = new Intl.Collator(locale, { sensitivity: 'accent', usage: 'sort' })\n\n  const transformedItems = items.map(item => (\n    [item, options?.transform ? options.transform(item) : item as never] as const)\n  )\n\n  return transformedItems.sort((a, b) => {\n    for (let i = 0; i < sortByItems.length; i++) {\n      let hasCustomResult = false\n      const sortKey = sortByItems[i].key\n      const sortOrder = sortByItems[i].order ?? 'asc'\n\n      if (sortOrder === false) continue\n\n      let sortA = getObjectValueByPath(a[1], sortKey)\n      let sortB = getObjectValueByPath(b[1], sortKey)\n      let sortARaw = a[0].raw\n      let sortBRaw = b[0].raw\n\n      if (sortOrder === 'desc') {\n        [sortA, sortB] = [sortB, sortA]\n        ;[sortARaw, sortBRaw] = [sortBRaw, sortARaw]\n      }\n\n      if (options?.sortRawFunctions?.[sortKey]) {\n        const customResult = options.sortRawFunctions[sortKey](sortARaw, sortBRaw)\n\n        if (customResult == null) continue\n        hasCustomResult = true\n        if (customResult) return customResult\n      }\n\n      if (options?.sortFunctions?.[sortKey]) {\n        const customResult = options.sortFunctions[sortKey](sortA, sortB)\n\n        if (customResult == null) continue\n        hasCustomResult = true\n        if (customResult) return customResult\n      }\n\n      if (hasCustomResult) continue\n\n      // Dates should be compared numerically\n      if (sortA instanceof Date && sortB instanceof Date) {\n        return sortA.getTime() - sortB.getTime()\n      }\n\n      [sortA, sortB] = [sortA, sortB].map(s => s != null ? s.toString().toLocaleLowerCase() : s)\n\n      if (sortA !== sortB) {\n        if (isEmpty(sortA) && isEmpty(sortB)) return 0\n        if (isEmpty(sortA)) return -1\n        if (isEmpty(sortB)) return 1\n        if (!isNaN(sortA) && !isNaN(sortB)) return Number(sortA) - Number(sortB)\n        return stringCollator.compare(sortA, sortB)\n      }\n    }\n\n    return 0\n  }).map(([item]) => item)\n}\n"]},"metadata":{},"sourceType":"module"}