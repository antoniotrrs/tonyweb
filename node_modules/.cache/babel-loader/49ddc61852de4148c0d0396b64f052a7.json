{"ast":null,"code":"import _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { createVNode as _createVNode } from \"vue\"; // Composables\n\nimport { makeComponentProps } from \"../../composables/component.js\";\nimport { createForm, makeFormProps } from \"../../composables/form.js\";\nimport { forwardRefs } from \"../../composables/forwardRefs.js\"; // Utilities\n\nimport { ref } from 'vue';\nimport { genericComponent, propsFactory, useRender } from \"../../util/index.js\"; // Types\n\nexport var makeVFormProps = propsFactory(_objectSpread(_objectSpread({}, makeComponentProps()), makeFormProps()), 'VForm');\nexport var VForm = genericComponent()({\n  name: 'VForm',\n  props: makeVFormProps(),\n  emits: {\n    'update:modelValue': function updateModelValue(val) {\n      return true;\n    },\n    submit: function submit(e) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        emit = _ref.emit;\n    var form = createForm(props);\n    var formRef = ref();\n\n    function onReset(e) {\n      e.preventDefault();\n      form.reset();\n    }\n\n    function onSubmit(_e) {\n      var e = _e;\n      var ready = form.validate();\n      e.then = ready.then.bind(ready);\n      e.catch = ready.catch.bind(ready);\n      e.finally = ready.finally.bind(ready);\n      emit('submit', e);\n\n      if (!e.defaultPrevented) {\n        ready.then(function (_ref2) {\n          var valid = _ref2.valid;\n\n          if (valid) {\n            var _formRef$value;\n\n            (_formRef$value = formRef.value) === null || _formRef$value === void 0 ? void 0 : _formRef$value.submit();\n          }\n        });\n      }\n\n      e.preventDefault();\n    }\n\n    useRender(function () {\n      var _slots$default;\n\n      return _createVNode(\"form\", {\n        \"ref\": formRef,\n        \"class\": ['v-form', props.class],\n        \"style\": props.style,\n        \"novalidate\": true,\n        \"onReset\": onReset,\n        \"onSubmit\": onSubmit\n      }, [(_slots$default = slots.default) === null || _slots$default === void 0 ? void 0 : _slots$default.call(slots, form)]);\n    });\n    return forwardRefs(form, formRef);\n  }\n});","map":{"version":3,"mappings":";;mDAAA;;AAAA,SACSA,kBADT,QAC2B,gCAD3B;AAC2B,SAClBC,UADkB,EACNC,aADM,QACO,2BADP;AACO,SACzBC,WADyB,QACd,kCADc,C,CAGlC;;AACA,SAASC,GAAT,QAAoB,KAApB;AAAyB,SAChBC,gBADgB,EACEC,YADF,EACgBC,SADhB,QACyB,qBADzB,C,CAGzB;;AAGA,OAAO,IAAMC,cAAc,GAAGF,YAAY,iCACrCN,kBAAkB,EADmB,GAErCE,aAAa,EAFwB,GAGvC,OAHuC,CAAnC;AASP,OAAO,IAAMO,KAAK,GAAGJ,gBAAgB,GAAe;AAClDK,MAAI,EAAE,OAD4C;AAGlDC,OAAK,EAAEH,cAAc,EAH6B;AAKlDI,OAAK,EAAE;AACL,yBAAsBC,6BAAmB;AAAA,aAAK,IAAL;AAAA,KADpC;AAELC,UAAM,EAAGC,iBAAqB;AAAA,aAAK,IAAL;AAAA;AAFzB,GAL2C;AAUlDC,OAVkD,iBAU3CL,KAV2C,EAUtCM,IAVsC,EAUnB;AAAA,QAAfC,KAAe,GAAFD,IAAE,CAAfC,KAAe;AAAA,QAARC,IAAQ,GAAFF,IAAE,CAARE,IAAQ;AAC7B,QAAMC,IAAI,GAAGnB,UAAU,CAACU,KAAD,CAAvB;AACA,QAAMU,OAAO,GAAGjB,GAAG,EAAnB;;AAEA,aAASkB,OAAT,CAAkBP,CAAlB,EAA4B;AAC1BA,OAAC,CAACQ,cAAFR;AACAK,UAAI,CAACI,KAALJ;AACF;;AAEA,aAASK,QAAT,CAAmBC,EAAnB,EAA8B;AAC5B,UAAMX,CAAC,GAAGW,EAAV;AAEA,UAAMC,KAAK,GAAGP,IAAI,CAACQ,QAALR,EAAd;AACAL,OAAC,CAACc,IAAFd,GAASY,KAAK,CAACE,IAANF,CAAWG,IAAXH,CAAgBA,KAAhBA,CAATZ;AACAA,OAAC,CAACgB,KAAFhB,GAAUY,KAAK,CAACI,KAANJ,CAAYG,IAAZH,CAAiBA,KAAjBA,CAAVZ;AACAA,OAAC,CAACiB,OAAFjB,GAAYY,KAAK,CAACK,OAANL,CAAcG,IAAdH,CAAmBA,KAAnBA,CAAZZ;AAEAI,UAAI,CAAC,QAAD,EAAWJ,CAAX,CAAJI;;AAEA,UAAI,CAACJ,CAAC,CAACkB,gBAAP,EAAyB;AACvBN,aAAK,CAACE,IAANF,CAAWO,iBAAe;AAAA,cAAZC,KAAY,GAALD,KAAK,CAAZC,KAAY;;AACxB,cAAIA,KAAJ,EAAW;AAAA;;AACTd,qCAAO,CAACe,KAARf,kEAAeP,MAAfO;AACF;AACD,SAJDM;AAKF;;AAEAZ,OAAC,CAACQ,cAAFR;AACF;;AAEAR,aAAS,CAAC;AAAA;;AAAA;AAAA,eAEAc,OAFA;AAEO,iBACN,CACL,QADK,EAELV,KAAK,CAAC0B,KAFD,CAHD;AAML,iBACO1B,KAAK,CAAC2B,KAPR;AAOa,0BAPb;AAOa,mBAEThB,OATJ;AASW,oBACNG;AAVL,SAUa,mBAEjBP,KAAK,CAACqB,OAFW,mDAEjBrB,yBAAK,EAAWE,IAAX,CAFY,CAVb;AAAA,KAAD,CAATb;AAgBA,WAAOJ,WAAW,CAACiB,IAAD,EAAOC,OAAP,CAAlB;AACF;AAzDkD,CAAf,CAA9B","names":["makeComponentProps","createForm","makeFormProps","forwardRefs","ref","genericComponent","propsFactory","useRender","makeVFormProps","VForm","name","props","emits","val","submit","e","setup","_ref","slots","emit","form","formRef","onReset","preventDefault","reset","onSubmit","_e","ready","validate","then","bind","catch","finally","defaultPrevented","_ref2","valid","value","class","style","default"],"sources":["../../../src/components/VForm/VForm.tsx"],"sourcesContent":["// Composables\nimport { makeComponentProps } from '@/composables/component'\nimport { createForm, makeFormProps } from '@/composables/form'\nimport { forwardRefs } from '@/composables/forwardRefs'\n\n// Utilities\nimport { ref } from 'vue'\nimport { genericComponent, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { SubmitEventPromise } from '@/composables/form'\n\nexport const makeVFormProps = propsFactory({\n  ...makeComponentProps(),\n  ...makeFormProps(),\n}, 'VForm')\n\ntype VFormSlots = {\n  default: ReturnType<typeof createForm>\n}\n\nexport const VForm = genericComponent<VFormSlots>()({\n  name: 'VForm',\n\n  props: makeVFormProps(),\n\n  emits: {\n    'update:modelValue': (val: boolean | null) => true,\n    submit: (e: SubmitEventPromise) => true,\n  },\n\n  setup (props, { slots, emit }) {\n    const form = createForm(props)\n    const formRef = ref<HTMLFormElement>()\n\n    function onReset (e: Event) {\n      e.preventDefault()\n      form.reset()\n    }\n\n    function onSubmit (_e: Event) {\n      const e = _e as SubmitEventPromise\n\n      const ready = form.validate()\n      e.then = ready.then.bind(ready)\n      e.catch = ready.catch.bind(ready)\n      e.finally = ready.finally.bind(ready)\n\n      emit('submit', e)\n\n      if (!e.defaultPrevented) {\n        ready.then(({ valid }) => {\n          if (valid) {\n            formRef.value?.submit()\n          }\n        })\n      }\n\n      e.preventDefault()\n    }\n\n    useRender(() => ((\n      <form\n        ref={ formRef }\n        class={[\n          'v-form',\n          props.class,\n        ]}\n        style={ props.style }\n        novalidate\n        onReset={ onReset }\n        onSubmit={ onSubmit }\n      >\n        { slots.default?.(form) }\n      </form>\n    )))\n\n    return forwardRefs(form, formRef)\n  },\n})\n\nexport type VForm = InstanceType<typeof VForm>\n"]},"metadata":{},"sourceType":"module"}