{"ast":null,"code":"import _toConsumableArray from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _typeof from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport { createTextVNode as _createTextVNode, createVNode as _createVNode } from \"vue\"; // Styles\n\nimport \"./VDatePickerMonth.css\"; // Components\n\nimport { VBtn } from \"../VBtn/index.js\"; // Composables\n\nimport { makeCalendarProps, useCalendar } from \"../../composables/calendar.js\";\nimport { useDate } from \"../../composables/date/date.js\";\nimport { MaybeTransition } from \"../../composables/transition.js\"; // Utilities\n\nimport { computed, ref, shallowRef, watch } from 'vue';\nimport { genericComponent, omit, propsFactory, useRender } from \"../../util/index.js\"; // Types\n\nexport var makeVDatePickerMonthProps = propsFactory(_objectSpread({\n  color: String,\n  hideWeekdays: Boolean,\n  multiple: [Boolean, Number, String],\n  showWeek: Boolean,\n  transition: {\n    type: String,\n    default: 'picker-transition'\n  },\n  reverseTransition: {\n    type: String,\n    default: 'picker-reverse-transition'\n  }\n}, omit(makeCalendarProps(), ['displayValue'])), 'VDatePickerMonth');\nexport var VDatePickerMonth = genericComponent()({\n  name: 'VDatePickerMonth',\n  props: makeVDatePickerMonthProps(),\n  emits: {\n    'update:modelValue': function updateModelValue(date) {\n      return true;\n    },\n    'update:month': function updateMonth(date) {\n      return true;\n    },\n    'update:year': function updateYear(date) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit,\n        slots = _ref.slots;\n    var daysRef = ref();\n\n    var _useCalendar = useCalendar(props),\n        daysInMonth = _useCalendar.daysInMonth,\n        model = _useCalendar.model,\n        weekNumbers = _useCalendar.weekNumbers;\n\n    var adapter = useDate();\n    var rangeStart = shallowRef();\n    var rangeStop = shallowRef();\n    var isReverse = shallowRef(false);\n    var transition = computed(function () {\n      return !isReverse.value ? props.transition : props.reverseTransition;\n    });\n\n    if (props.multiple === 'range' && model.value.length > 0) {\n      rangeStart.value = model.value[0];\n\n      if (model.value.length > 1) {\n        rangeStop.value = model.value[model.value.length - 1];\n      }\n    }\n\n    var atMax = computed(function () {\n      var max = ['number', 'string'].includes(_typeof(props.multiple)) ? Number(props.multiple) : Infinity;\n      return model.value.length >= max;\n    });\n    watch(daysInMonth, function (val, oldVal) {\n      if (!oldVal) return;\n      isReverse.value = adapter.isBefore(val[0].date, oldVal[0].date);\n    });\n\n    function onRangeClick(value) {\n      var _value = adapter.startOfDay(value);\n\n      if (model.value.length === 0) {\n        rangeStart.value = undefined;\n      } else if (model.value.length === 1) {\n        rangeStart.value = model.value[0];\n        rangeStop.value = undefined;\n      }\n\n      if (!rangeStart.value) {\n        rangeStart.value = _value;\n        model.value = [rangeStart.value];\n      } else if (!rangeStop.value) {\n        if (adapter.isSameDay(_value, rangeStart.value)) {\n          rangeStart.value = undefined;\n          model.value = [];\n          return;\n        } else if (adapter.isBefore(_value, rangeStart.value)) {\n          rangeStop.value = adapter.endOfDay(rangeStart.value);\n          rangeStart.value = _value;\n        } else {\n          rangeStop.value = adapter.endOfDay(_value);\n        }\n\n        var diff = adapter.getDiff(rangeStop.value, rangeStart.value, 'days');\n        var datesInRange = [rangeStart.value];\n\n        for (var i = 1; i < diff; i++) {\n          var nextDate = adapter.addDays(rangeStart.value, i);\n          datesInRange.push(nextDate);\n        }\n\n        datesInRange.push(rangeStop.value);\n        model.value = datesInRange;\n      } else {\n        rangeStart.value = value;\n        rangeStop.value = undefined;\n        model.value = [rangeStart.value];\n      }\n    }\n\n    function onMultipleClick(value) {\n      var index = model.value.findIndex(function (selection) {\n        return adapter.isSameDay(selection, value);\n      });\n\n      if (index === -1) {\n        model.value = [].concat(_toConsumableArray(model.value), [value]);\n      } else {\n        var _value2 = _toConsumableArray(model.value);\n\n        _value2.splice(index, 1);\n\n        model.value = _value2;\n      }\n    }\n\n    function _onClick(value) {\n      if (props.multiple === 'range') {\n        onRangeClick(value);\n      } else if (props.multiple) {\n        onMultipleClick(value);\n      } else {\n        model.value = [value];\n      }\n    }\n\n    useRender(function () {\n      return _createVNode(\"div\", {\n        \"class\": \"v-date-picker-month\"\n      }, [props.showWeek && _createVNode(\"div\", {\n        \"key\": \"weeks\",\n        \"class\": \"v-date-picker-month__weeks\"\n      }, [!props.hideWeekdays && _createVNode(\"div\", {\n        \"key\": \"hide-week-days\",\n        \"class\": \"v-date-picker-month__day\"\n      }, [_createTextVNode(\"\\xA0\")]), weekNumbers.value.map(function (week) {\n        return _createVNode(\"div\", {\n          \"class\": ['v-date-picker-month__day', 'v-date-picker-month__day--adjacent']\n        }, [week]);\n      })]), _createVNode(MaybeTransition, {\n        \"name\": transition.value\n      }, {\n        default: function _default() {\n          var _daysInMonth$value$0$;\n\n          return [_createVNode(\"div\", {\n            \"ref\": daysRef,\n            \"key\": (_daysInMonth$value$0$ = daysInMonth.value[0].date) === null || _daysInMonth$value$0$ === void 0 ? void 0 : _daysInMonth$value$0$.toString(),\n            \"class\": \"v-date-picker-month__days\"\n          }, [!props.hideWeekdays && adapter.getWeekdays(props.firstDayOfWeek).map(function (weekDay) {\n            return _createVNode(\"div\", {\n              \"class\": ['v-date-picker-month__day', 'v-date-picker-month__weekday']\n            }, [weekDay]);\n          }), daysInMonth.value.map(function (item, i) {\n            var _slots$day, _slots$day2;\n\n            var slotProps = {\n              props: {\n                class: 'v-date-picker-month__day-btn',\n                color: item.isSelected || item.isToday ? props.color : undefined,\n                disabled: item.isDisabled,\n                icon: true,\n                ripple: false,\n                text: item.localized,\n                variant: item.isSelected ? 'flat' : item.isToday ? 'outlined' : 'text',\n                onClick: function onClick() {\n                  return _onClick(item.date);\n                }\n              },\n              item: item,\n              i: i\n            };\n\n            if (atMax.value && !item.isSelected) {\n              item.isDisabled = true;\n            }\n\n            return _createVNode(\"div\", {\n              \"class\": ['v-date-picker-month__day', {\n                'v-date-picker-month__day--adjacent': item.isAdjacent,\n                'v-date-picker-month__day--hide-adjacent': item.isHidden,\n                'v-date-picker-month__day--selected': item.isSelected,\n                'v-date-picker-month__day--week-end': item.isWeekEnd,\n                'v-date-picker-month__day--week-start': item.isWeekStart\n              }],\n              \"data-v-date\": !item.isDisabled ? item.isoDate : undefined\n            }, [(props.showAdjacentMonths || !item.isAdjacent) && ((_slots$day = (_slots$day2 = slots.day) === null || _slots$day2 === void 0 ? void 0 : _slots$day2.call(slots, slotProps)) !== null && _slots$day !== void 0 ? _slots$day : _createVNode(VBtn, slotProps.props, null))]);\n          })])];\n        }\n      })]);\n    });\n  }\n});","map":{"version":3,"mappings":"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","names":["VBtn","makeCalendarProps","useCalendar","useDate","MaybeTransition","computed","ref","shallowRef","watch","genericComponent","omit","propsFactory","useRender","makeVDatePickerMonthProps","color","String","hideWeekdays","Boolean","multiple","Number","showWeek","transition","type","default","reverseTransition","VDatePickerMonth","name","props","emits","date","setup","_ref","emit","slots","daysRef","daysInMonth","model","weekNumbers","adapter","rangeStart","rangeStop","isReverse","value","length","atMax","max","includes","Infinity","val","oldVal","isBefore","onRangeClick","_value","startOfDay","undefined","isSameDay","endOfDay","diff","getDiff","datesInRange","i","nextDate","addDays","push","onMultipleClick","index","findIndex","selection","splice","onClick","_createVNode","map","week","toString","getWeekdays","firstDayOfWeek","weekDay","item","slotProps","class","isSelected","isToday","disabled","isDisabled","icon","ripple","text","localized","variant","isAdjacent","isHidden","isWeekEnd","isWeekStart","isoDate","showAdjacentMonths","day"],"sources":["../../../src/components/VDatePicker/VDatePickerMonth.tsx"],"sourcesContent":["// Styles\nimport './VDatePickerMonth.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\n\n// Composables\nimport { makeCalendarProps, useCalendar } from '@/composables/calendar'\nimport { useDate } from '@/composables/date/date'\nimport { MaybeTransition } from '@/composables/transition'\n\n// Utilities\nimport { computed, ref, shallowRef, watch } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport type VDatePickerMonthSlots = {\n  day: {\n    props: {\n      onClick: () => void\n    }\n    item: any\n    i: number\n  }\n}\n\nexport const makeVDatePickerMonthProps = propsFactory({\n  color: String,\n  hideWeekdays: Boolean,\n  multiple: [Boolean, Number, String] as PropType<boolean | 'range' | number | (string & {})>,\n  showWeek: Boolean,\n  transition: {\n    type: String,\n    default: 'picker-transition',\n  },\n  reverseTransition: {\n    type: String,\n    default: 'picker-reverse-transition',\n  },\n\n  ...omit(makeCalendarProps(), ['displayValue']),\n}, 'VDatePickerMonth')\n\nexport const VDatePickerMonth = genericComponent<VDatePickerMonthSlots>()({\n  name: 'VDatePickerMonth',\n\n  props: makeVDatePickerMonthProps(),\n\n  emits: {\n    'update:modelValue': (date: unknown) => true,\n    'update:month': (date: number) => true,\n    'update:year': (date: number) => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const daysRef = ref()\n\n    const { daysInMonth, model, weekNumbers } = useCalendar(props)\n    const adapter = useDate()\n\n    const rangeStart = shallowRef()\n    const rangeStop = shallowRef()\n    const isReverse = shallowRef(false)\n\n    const transition = computed(() => {\n      return !isReverse.value ? props.transition : props.reverseTransition\n    })\n\n    if (props.multiple === 'range' && model.value.length > 0) {\n      rangeStart.value = model.value[0]\n      if (model.value.length > 1) {\n        rangeStop.value = model.value[model.value.length - 1]\n      }\n    }\n\n    const atMax = computed(() => {\n      const max = ['number', 'string'].includes(typeof props.multiple) ? Number(props.multiple) : Infinity\n\n      return model.value.length >= max\n    })\n\n    watch(daysInMonth, (val, oldVal) => {\n      if (!oldVal) return\n\n      isReverse.value = adapter.isBefore(val[0].date, oldVal[0].date)\n    })\n\n    function onRangeClick (value: unknown) {\n      const _value = adapter.startOfDay(value)\n\n      if (model.value.length === 0) {\n        rangeStart.value = undefined\n      } else if (model.value.length === 1) {\n        rangeStart.value = model.value[0]\n        rangeStop.value = undefined\n      }\n      if (!rangeStart.value) {\n        rangeStart.value = _value\n        model.value = [rangeStart.value]\n      } else if (!rangeStop.value) {\n        if (adapter.isSameDay(_value, rangeStart.value)) {\n          rangeStart.value = undefined\n          model.value = []\n          return\n        } else if (adapter.isBefore(_value, rangeStart.value)) {\n          rangeStop.value = adapter.endOfDay(rangeStart.value)\n          rangeStart.value = _value\n        } else {\n          rangeStop.value = adapter.endOfDay(_value)\n        }\n\n        const diff = adapter.getDiff(rangeStop.value, rangeStart.value, 'days')\n        const datesInRange = [rangeStart.value]\n\n        for (let i = 1; i < diff; i++) {\n          const nextDate = adapter.addDays(rangeStart.value, i)\n          datesInRange.push(nextDate)\n        }\n\n        datesInRange.push(rangeStop.value)\n\n        model.value = datesInRange\n      } else {\n        rangeStart.value = value\n        rangeStop.value = undefined\n        model.value = [rangeStart.value]\n      }\n    }\n\n    function onMultipleClick (value: unknown) {\n      const index = model.value.findIndex(selection => adapter.isSameDay(selection, value))\n\n      if (index === -1) {\n        model.value = [...model.value, value]\n      } else {\n        const value = [...model.value]\n        value.splice(index, 1)\n        model.value = value\n      }\n    }\n\n    function onClick (value: unknown) {\n      if (props.multiple === 'range') {\n        onRangeClick(value)\n      } else if (props.multiple) {\n        onMultipleClick(value)\n      } else {\n        model.value = [value]\n      }\n    }\n\n    useRender(() => (\n      <div class=\"v-date-picker-month\">\n        { props.showWeek && (\n          <div key=\"weeks\" class=\"v-date-picker-month__weeks\">\n            { !props.hideWeekdays && (\n              <div key=\"hide-week-days\" class=\"v-date-picker-month__day\">&nbsp;</div>\n            )}\n            { weekNumbers.value.map(week => (\n              <div\n                class={[\n                  'v-date-picker-month__day',\n                  'v-date-picker-month__day--adjacent',\n                ]}\n              >{ week }</div>\n            ))}\n          </div>\n        )}\n\n        <MaybeTransition name={ transition.value }>\n          <div\n            ref={ daysRef }\n            key={ daysInMonth.value[0].date?.toString() }\n            class=\"v-date-picker-month__days\"\n          >\n            { !props.hideWeekdays && adapter.getWeekdays(props.firstDayOfWeek).map(weekDay => (\n              <div\n                class={[\n                  'v-date-picker-month__day',\n                  'v-date-picker-month__weekday',\n                ]}\n              >{ weekDay }</div>\n            ))}\n\n            { daysInMonth.value.map((item, i) => {\n              const slotProps = {\n                props: {\n                  class: 'v-date-picker-month__day-btn',\n                  color: item.isSelected || item.isToday ? props.color : undefined,\n                  disabled: item.isDisabled,\n                  icon: true,\n                  ripple: false,\n                  text: item.localized,\n                  variant: item.isSelected ? 'flat' : item.isToday ? 'outlined' : 'text',\n                  onClick: () => onClick(item.date),\n                },\n                item,\n                i,\n              } as const\n\n              if (atMax.value && !item.isSelected) {\n                item.isDisabled = true\n              }\n\n              return (\n                <div\n                  class={[\n                    'v-date-picker-month__day',\n                    {\n                      'v-date-picker-month__day--adjacent': item.isAdjacent,\n                      'v-date-picker-month__day--hide-adjacent': item.isHidden,\n                      'v-date-picker-month__day--selected': item.isSelected,\n                      'v-date-picker-month__day--week-end': item.isWeekEnd,\n                      'v-date-picker-month__day--week-start': item.isWeekStart,\n                    },\n                  ]}\n                  data-v-date={ !item.isDisabled ? item.isoDate : undefined }\n                >\n                  { (props.showAdjacentMonths || !item.isAdjacent) && (\n                    slots.day?.(slotProps) ?? (<VBtn { ...slotProps.props } />)\n                  )}\n                </div>\n              )\n            })}\n          </div>\n        </MaybeTransition>\n      </div>\n    ))\n  },\n})\n\nexport type VDatePickerMonth = InstanceType<typeof VDatePickerMonth>\n"]},"metadata":{},"sourceType":"module"}