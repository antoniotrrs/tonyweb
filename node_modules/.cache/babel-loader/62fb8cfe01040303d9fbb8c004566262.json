{"ast":null,"code":"/* eslint-disable sonarjs/no-identical-functions */\n// Utilities\nimport { toRaw } from 'vue';\nimport { wrapInArray } from \"../../util/index.js\";\nexport const independentActiveStrategy = mandatory => {\n  const strategy = {\n    activate: _ref => {\n      let {\n        id,\n        value,\n        activated\n      } = _ref;\n      id = toRaw(id); // When mandatory and we're trying to deselect when id\n      // is the only currently selected item then do nothing\n\n      if (mandatory && !value && activated.size === 1 && activated.has(id)) return activated;\n\n      if (value) {\n        activated.add(id);\n      } else {\n        activated.delete(id);\n      }\n\n      return activated;\n    },\n    in: (v, children, parents) => {\n      let set = new Set();\n\n      if (v != null) {\n        for (const id of wrapInArray(v)) {\n          set = strategy.activate({\n            id,\n            value: true,\n            activated: new Set(set),\n            children,\n            parents\n          });\n        }\n      }\n\n      return set;\n    },\n    out: v => {\n      return Array.from(v);\n    }\n  };\n  return strategy;\n};\nexport const independentSingleActiveStrategy = mandatory => {\n  const parentStrategy = independentActiveStrategy(mandatory);\n  const strategy = {\n    activate: _ref2 => {\n      let {\n        activated,\n        id,\n        ...rest\n      } = _ref2;\n      id = toRaw(id);\n      const singleSelected = activated.has(id) ? new Set([id]) : new Set();\n      return parentStrategy.activate({ ...rest,\n        id,\n        activated: singleSelected\n      });\n    },\n    in: (v, children, parents) => {\n      let set = new Set();\n\n      if (v != null) {\n        const arr = wrapInArray(v);\n\n        if (arr.length) {\n          set = parentStrategy.in(arr.slice(0, 1), children, parents);\n        }\n      }\n\n      return set;\n    },\n    out: (v, children, parents) => {\n      return parentStrategy.out(v, children, parents);\n    }\n  };\n  return strategy;\n};\nexport const leafActiveStrategy = mandatory => {\n  const parentStrategy = independentActiveStrategy(mandatory);\n  const strategy = {\n    activate: _ref3 => {\n      let {\n        id,\n        activated,\n        children,\n        ...rest\n      } = _ref3;\n      id = toRaw(id);\n      if (children.has(id)) return activated;\n      return parentStrategy.activate({\n        id,\n        activated,\n        children,\n        ...rest\n      });\n    },\n    in: parentStrategy.in,\n    out: parentStrategy.out\n  };\n  return strategy;\n};\nexport const leafSingleActiveStrategy = mandatory => {\n  const parentStrategy = independentSingleActiveStrategy(mandatory);\n  const strategy = {\n    activate: _ref4 => {\n      let {\n        id,\n        activated,\n        children,\n        ...rest\n      } = _ref4;\n      id = toRaw(id);\n      if (children.has(id)) return activated;\n      return parentStrategy.activate({\n        id,\n        activated,\n        children,\n        ...rest\n      });\n    },\n    in: parentStrategy.in,\n    out: parentStrategy.out\n  };\n  return strategy;\n};","map":{"version":3,"mappings":"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","names":["toRaw","wrapInArray","independentActiveStrategy","mandatory","strategy","activate","_ref","id","value","activated","size","has","add","delete","in","v","children","parents","set","Set","out","Array","from","independentSingleActiveStrategy","parentStrategy","_ref2","rest","singleSelected","arr","length","slice","leafActiveStrategy","_ref3","leafSingleActiveStrategy","_ref4"],"sources":["../../../src/composables/nested/activeStrategies.ts"],"sourcesContent":["/* eslint-disable sonarjs/no-identical-functions */\n// Utilities\nimport { toRaw } from 'vue'\nimport { wrapInArray } from '@/util'\n\ntype ActiveStrategyFunction = (data: {\n  id: unknown\n  value: boolean\n  activated: Set<unknown>\n  children: Map<unknown, unknown[]>\n  parents: Map<unknown, unknown>\n  event?: Event\n}) => Set<unknown>\n\ntype ActiveStrategyTransformInFunction = (\n  v: unknown | undefined,\n  children: Map<unknown, unknown[]>,\n  parents: Map<unknown, unknown>,\n) => Set<unknown>\n\ntype ActiveStrategyTransformOutFunction = (\n  v: Set<unknown>,\n  children: Map<unknown, unknown[]>,\n  parents: Map<unknown, unknown>,\n) => unknown\n\nexport type ActiveStrategy = {\n  activate: ActiveStrategyFunction\n  in: ActiveStrategyTransformInFunction\n  out: ActiveStrategyTransformOutFunction\n}\n\nexport const independentActiveStrategy = (mandatory?: boolean): ActiveStrategy => {\n  const strategy: ActiveStrategy = {\n    activate: ({ id, value, activated }) => {\n      id = toRaw(id)\n\n      // When mandatory and we're trying to deselect when id\n      // is the only currently selected item then do nothing\n      if (mandatory && !value && activated.size === 1 && activated.has(id)) return activated\n\n      if (value) {\n        activated.add(id)\n      } else {\n        activated.delete(id)\n      }\n\n      return activated\n    },\n    in: (v, children, parents) => {\n      let set = new Set()\n\n      if (v != null) {\n        for (const id of wrapInArray(v)) {\n          set = strategy.activate({\n            id,\n            value: true,\n            activated: new Set(set),\n            children,\n            parents,\n          })\n        }\n      }\n\n      return set\n    },\n    out: v => {\n      return Array.from(v)\n    },\n  }\n\n  return strategy\n}\n\nexport const independentSingleActiveStrategy = (mandatory?: boolean): ActiveStrategy => {\n  const parentStrategy = independentActiveStrategy(mandatory)\n\n  const strategy: ActiveStrategy = {\n    activate: ({ activated, id, ...rest }) => {\n      id = toRaw(id)\n      const singleSelected = activated.has(id) ? new Set([id]) : new Set()\n      return parentStrategy.activate({ ...rest, id, activated: singleSelected })\n    },\n    in: (v, children, parents) => {\n      let set = new Set()\n\n      if (v != null) {\n        const arr = wrapInArray(v)\n        if (arr.length) {\n          set = parentStrategy.in(arr.slice(0, 1), children, parents)\n        }\n      }\n\n      return set\n    },\n    out: (v, children, parents) => {\n      return parentStrategy.out(v, children, parents)\n    },\n  }\n\n  return strategy\n}\n\nexport const leafActiveStrategy = (mandatory?: boolean): ActiveStrategy => {\n  const parentStrategy = independentActiveStrategy(mandatory)\n\n  const strategy: ActiveStrategy = {\n    activate: ({ id, activated, children, ...rest }) => {\n      id = toRaw(id)\n      if (children.has(id)) return activated\n\n      return parentStrategy.activate({ id, activated, children, ...rest })\n    },\n    in: parentStrategy.in,\n    out: parentStrategy.out,\n  }\n\n  return strategy\n}\n\nexport const leafSingleActiveStrategy = (mandatory?: boolean): ActiveStrategy => {\n  const parentStrategy = independentSingleActiveStrategy(mandatory)\n\n  const strategy: ActiveStrategy = {\n    activate: ({ id, activated, children, ...rest }) => {\n      id = toRaw(id)\n      if (children.has(id)) return activated\n\n      return parentStrategy.activate({ id, activated, children, ...rest })\n    },\n    in: parentStrategy.in,\n    out: parentStrategy.out,\n  }\n\n  return strategy\n}\n"]},"metadata":{},"sourceType":"module"}