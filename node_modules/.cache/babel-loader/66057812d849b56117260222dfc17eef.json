{"ast":null,"code":"import _typeof from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport _objectWithoutProperties from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"once\", \"immediate\"];\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.string.sub.js\";\n\n// Types\nfunction mounted(el, binding) {\n  var _modifierKeys$attr, _modifierKeys$char, _modifierKeys$child, _modifierKeys$sub;\n\n  var modifiers = binding.modifiers || {};\n  var value = binding.value;\n\n  var once = modifiers.once,\n      immediate = modifiers.immediate,\n      modifierKeys = _objectWithoutProperties(modifiers, _excluded);\n\n  var defaultValue = !Object.keys(modifierKeys).length;\n\n  var _ref = _typeof(value) === 'object' ? value : {\n    handler: value,\n    options: {\n      attributes: (_modifierKeys$attr = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.attr) !== null && _modifierKeys$attr !== void 0 ? _modifierKeys$attr : defaultValue,\n      characterData: (_modifierKeys$char = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.char) !== null && _modifierKeys$char !== void 0 ? _modifierKeys$char : defaultValue,\n      childList: (_modifierKeys$child = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.child) !== null && _modifierKeys$child !== void 0 ? _modifierKeys$child : defaultValue,\n      subtree: (_modifierKeys$sub = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.sub) !== null && _modifierKeys$sub !== void 0 ? _modifierKeys$sub : defaultValue\n    }\n  },\n      handler = _ref.handler,\n      options = _ref.options;\n\n  var observer = new MutationObserver(function () {\n    var mutations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var observer = arguments.length > 1 ? arguments[1] : undefined;\n    handler === null || handler === void 0 ? void 0 : handler(mutations, observer);\n    if (once) unmounted(el, binding);\n  });\n  if (immediate) handler === null || handler === void 0 ? void 0 : handler([], observer);\n  el._mutate = Object(el._mutate);\n  el._mutate[binding.instance.$.uid] = {\n    observer: observer\n  };\n  observer.observe(el, options);\n}\n\nfunction unmounted(el, binding) {\n  var _el$_mutate;\n\n  if (!((_el$_mutate = el._mutate) !== null && _el$_mutate !== void 0 && _el$_mutate[binding.instance.$.uid])) return;\n\n  el._mutate[binding.instance.$.uid].observer.disconnect();\n\n  delete el._mutate[binding.instance.$.uid];\n}\n\nexport var Mutate = {\n  mounted: mounted,\n  unmounted: unmounted\n};\nexport default Mutate;","map":{"version":3,"mappings":";;;;;;AAAA;AASA,SAASA,OAAT,CAAkBC,EAAlB,EAAmCC,OAAnC,EAAsE;AAAA;;AACpE,MAAMC,SAAS,GAAGD,OAAO,CAACC,SAARD,IAAqB,EAAvC;AACA,MAAME,KAAK,GAAGF,OAAO,CAACE,KAAtB;;AACA,MAAQC,IAAR,GAA6CF,SAA7C,CAAQE,IAAR;AAAA,MAAcC,SAAd,GAA6CH,SAA7C,CAAcG,SAAd;AAAA,MAA4BC,YAA5B,4BAA6CJ,SAA7C;;AACA,MAAMK,YAAY,GAAG,CAACC,MAAM,CAACC,IAAPD,CAAYF,YAAZE,EAA0BE,MAAhD;;AAEA,aAA6B,QAAOP,KAAP,MAAiB,QAAjB,GACzBA,KADyB,GAEzB;AACAQ,WAAO,EAAER,KADT;AAEAS,WAAO,EAAE;AACPC,gBAAU,wBAAEP,YAAF,aAAEA,YAAF,uBAAEA,YAAY,CAAEQ,IAAhB,mEAAwBP,YAD3B;AAEPQ,mBAAa,wBAAET,YAAF,aAAEA,YAAF,uBAAEA,YAAY,CAAEU,IAAhB,mEAAwBT,YAF9B;AAGPU,eAAS,yBAAEX,YAAF,aAAEA,YAAF,uBAAEA,YAAY,CAAEY,KAAhB,qEAAyBX,YAH3B;AAIPY,aAAO,uBAAEb,YAAF,aAAEA,YAAF,uBAAEA,YAAY,CAAEc,GAAhB,iEAAuBb;AAJvB;AAFT,GAFJ;AAAA,MAAQI,OAAR,QAAQA,OAAR;AAAA,MAAiBC,OAAjB,QAAiBA,OAAjB;;AAYA,MAAMS,QAAQ,GAAG,IAAIC,gBAAJ,CAAqB,YAGjC;AAAA,QAFHC,SAA2B,uEAAG,EAE3B;AAF6B,QAChCF,QAA0B,kDADM;AAGhCV,WAAO,SAAPA,WAAO,WAAPA,mBAAO,CAAGY,SAAH,EAAcF,QAAd,CAAPV;AAEA,QAAIP,IAAJ,EAAUoB,SAAS,CAACxB,EAAD,EAAKC,OAAL,CAATuB;AACX,GAPgB,CAAjB;AASA,MAAInB,SAAJ,EAAeM,OAAO,SAAPA,WAAO,WAAPA,mBAAO,CAAG,EAAH,EAAOU,QAAP,CAAPV;AAEfX,IAAE,CAACyB,OAAHzB,GAAaQ,MAAM,CAACR,EAAE,CAACyB,OAAJ,CAAnBzB;AACAA,IAAE,CAACyB,OAAHzB,CAAYC,OAAO,CAACyB,QAARzB,CAAkB0B,CAAlB1B,CAAoB2B,GAAhC5B,IAAuC;AAAEqB;AAAF,GAAvCrB;AAEAqB,UAAQ,CAACQ,OAATR,CAAiBrB,EAAjBqB,EAAqBT,OAArBS;AACF;;AAEA,SAASG,SAAT,CAAoBxB,EAApB,EAAqCC,OAArC,EAAwE;AAAA;;AACtE,MAAI,iBAACD,EAAE,CAACyB,OAAJ,wCAACzB,YAAaC,OAAO,CAACyB,QAARzB,CAAkB0B,CAAlB1B,CAAoB2B,GAAjC5B,CAAD,CAAJ,EAA4C;;AAE5CA,IAAE,CAACyB,OAAHzB,CAAWC,OAAO,CAACyB,QAARzB,CAAkB0B,CAAlB1B,CAAoB2B,GAA/B5B,EAAqCqB,QAArCrB,CAA8C8B,UAA9C9B;;AACA,SAAOA,EAAE,CAACyB,OAAHzB,CAAWC,OAAO,CAACyB,QAARzB,CAAkB0B,CAAlB1B,CAAoB2B,GAA/B5B,CAAP;AACF;;AAEA,OAAO,IAAM+B,MAAM,GAAG;AACpBhC,SAAO,EAAPA,OADoB;AAEpByB;AAFoB,CAAf;AAKP,eAAeO,MAAf","names":["mounted","el","binding","modifiers","value","once","immediate","modifierKeys","defaultValue","Object","keys","length","handler","options","attributes","attr","characterData","char","childList","child","subtree","sub","observer","MutationObserver","mutations","unmounted","_mutate","instance","$","uid","observe","disconnect","Mutate"],"sources":["../../../src/directives/mutate/index.ts"],"sourcesContent":["// Types\nimport type { DirectiveBinding } from 'vue'\nimport type { MutationOptions } from '@/composables/mutationObserver'\n\nexport interface MutationDirectiveBinding extends Omit<DirectiveBinding, 'modifiers' | 'value'> {\n  value: MutationCallback | { handler: MutationCallback, options?: MutationObserverInit }\n  modifiers: MutationOptions\n}\n\nfunction mounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  const modifiers = binding.modifiers || {}\n  const value = binding.value\n  const { once, immediate, ...modifierKeys } = modifiers\n  const defaultValue = !Object.keys(modifierKeys).length\n\n  const { handler, options } = typeof value === 'object'\n    ? value\n    : {\n      handler: value,\n      options: {\n        attributes: modifierKeys?.attr ?? defaultValue,\n        characterData: modifierKeys?.char ?? defaultValue,\n        childList: modifierKeys?.child ?? defaultValue,\n        subtree: modifierKeys?.sub ?? defaultValue,\n      },\n    }\n\n  const observer = new MutationObserver((\n    mutations: MutationRecord[] = [],\n    observer: MutationObserver\n  ) => {\n    handler?.(mutations, observer)\n\n    if (once) unmounted(el, binding)\n  })\n\n  if (immediate) handler?.([], observer)\n\n  el._mutate = Object(el._mutate)\n  el._mutate![binding.instance!.$.uid] = { observer }\n\n  observer.observe(el, options)\n}\n\nfunction unmounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  if (!el._mutate?.[binding.instance!.$.uid]) return\n\n  el._mutate[binding.instance!.$.uid]!.observer.disconnect()\n  delete el._mutate[binding.instance!.$.uid]\n}\n\nexport const Mutate = {\n  mounted,\n  unmounted,\n}\n\nexport default Mutate\n"]},"metadata":{},"sourceType":"module"}