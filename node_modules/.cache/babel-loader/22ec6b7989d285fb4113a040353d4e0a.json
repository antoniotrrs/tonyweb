{"ast":null,"code":"import _objectSpread from \"/Users/antoniotorres/Documents/tony/tonyweb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport { createVNode as _createVNode, Fragment as _Fragment } from \"vue\"; // Styles\n\nimport \"./VVirtualScroll.css\"; // Components\n\nimport { VVirtualScrollItem } from \"./VVirtualScrollItem.js\"; // Composables\n\nimport { makeComponentProps } from \"../../composables/component.js\";\nimport { makeDimensionProps, useDimension } from \"../../composables/dimensions.js\";\nimport { useToggleScope } from \"../../composables/toggleScope.js\";\nimport { makeVirtualProps, useVirtual } from \"../../composables/virtual.js\"; // Utilities\n\nimport { onMounted, onScopeDispose, toRef } from 'vue';\nimport { convertToUnit, genericComponent, getCurrentInstance, getScrollParent, propsFactory, useRender } from \"../../util/index.js\"; // Types\n\nexport var makeVVirtualScrollProps = propsFactory(_objectSpread(_objectSpread(_objectSpread({\n  items: {\n    type: Array,\n    default: function _default() {\n      return [];\n    }\n  },\n  renderless: Boolean\n}, makeVirtualProps()), makeComponentProps()), makeDimensionProps()), 'VVirtualScroll');\nexport var VVirtualScroll = genericComponent()({\n  name: 'VVirtualScroll',\n  props: makeVVirtualScrollProps(),\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots;\n    var vm = getCurrentInstance('VVirtualScroll');\n\n    var _useDimension = useDimension(props),\n        dimensionStyles = _useDimension.dimensionStyles;\n\n    var _useVirtual = useVirtual(props, toRef(props, 'items')),\n        calculateVisibleItems = _useVirtual.calculateVisibleItems,\n        containerRef = _useVirtual.containerRef,\n        markerRef = _useVirtual.markerRef,\n        handleScroll = _useVirtual.handleScroll,\n        handleScrollend = _useVirtual.handleScrollend,\n        handleItemResize = _useVirtual.handleItemResize,\n        scrollToIndex = _useVirtual.scrollToIndex,\n        paddingTop = _useVirtual.paddingTop,\n        paddingBottom = _useVirtual.paddingBottom,\n        computedItems = _useVirtual.computedItems;\n\n    useToggleScope(function () {\n      return props.renderless;\n    }, function () {\n      function handleListeners() {\n        var add = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n        var method = add ? 'addEventListener' : 'removeEventListener';\n\n        if (containerRef.value === document.documentElement) {\n          document[method]('scroll', handleScroll, {\n            passive: true\n          });\n          document[method]('scrollend', handleScrollend);\n        } else {\n          var _containerRef$value, _containerRef$value2;\n\n          (_containerRef$value = containerRef.value) === null || _containerRef$value === void 0 ? void 0 : _containerRef$value[method]('scroll', handleScroll, {\n            passive: true\n          });\n          (_containerRef$value2 = containerRef.value) === null || _containerRef$value2 === void 0 ? void 0 : _containerRef$value2[method]('scrollend', handleScrollend);\n        }\n      }\n\n      onMounted(function () {\n        containerRef.value = getScrollParent(vm.vnode.el, true);\n        handleListeners(true);\n      });\n      onScopeDispose(handleListeners);\n    });\n    useRender(function () {\n      var children = computedItems.value.map(function (item) {\n        return _createVNode(VVirtualScrollItem, {\n          \"key\": item.key,\n          \"renderless\": props.renderless,\n          \"onUpdate:height\": function onUpdateHeight(height) {\n            return handleItemResize(item.index, height);\n          }\n        }, {\n          default: function _default(slotProps) {\n            var _slots$default;\n\n            return (_slots$default = slots.default) === null || _slots$default === void 0 ? void 0 : _slots$default.call(slots, _objectSpread({\n              item: item.raw,\n              index: item.index\n            }, slotProps));\n          }\n        });\n      });\n      return props.renderless ? _createVNode(_Fragment, null, [_createVNode(\"div\", {\n        \"ref\": markerRef,\n        \"class\": \"v-virtual-scroll__spacer\",\n        \"style\": {\n          paddingTop: convertToUnit(paddingTop.value)\n        }\n      }, null), children, _createVNode(\"div\", {\n        \"class\": \"v-virtual-scroll__spacer\",\n        \"style\": {\n          paddingBottom: convertToUnit(paddingBottom.value)\n        }\n      }, null)]) : _createVNode(\"div\", {\n        \"ref\": containerRef,\n        \"class\": ['v-virtual-scroll', props.class],\n        \"onScrollPassive\": handleScroll,\n        \"onScrollend\": handleScrollend,\n        \"style\": [dimensionStyles.value, props.style]\n      }, [_createVNode(\"div\", {\n        \"ref\": markerRef,\n        \"class\": \"v-virtual-scroll__container\",\n        \"style\": {\n          paddingTop: convertToUnit(paddingTop.value),\n          paddingBottom: convertToUnit(paddingBottom.value)\n        }\n      }, [children])]);\n    });\n    return {\n      calculateVisibleItems: calculateVisibleItems,\n      scrollToIndex: scrollToIndex\n    };\n  }\n});","map":{"version":3,"mappings":"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","names":["VVirtualScrollItem","makeComponentProps","makeDimensionProps","useDimension","useToggleScope","makeVirtualProps","useVirtual","onMounted","onScopeDispose","toRef","convertToUnit","genericComponent","getCurrentInstance","getScrollParent","propsFactory","useRender","makeVVirtualScrollProps","items","type","Array","default","renderless","Boolean","VVirtualScroll","name","props","setup","_ref","slots","vm","dimensionStyles","calculateVisibleItems","containerRef","markerRef","handleScroll","handleScrollend","handleItemResize","scrollToIndex","paddingTop","paddingBottom","computedItems","handleListeners","add","method","value","document","documentElement","passive","vnode","el","children","map","item","key","height","index","slotProps","raw","_createVNode","class","style"],"sources":["../../../src/components/VVirtualScroll/VVirtualScroll.tsx"],"sourcesContent":["// Styles\nimport './VVirtualScroll.sass'\n\n// Components\nimport { VVirtualScrollItem } from './VVirtualScrollItem'\n\n// Composables\nimport { makeComponentProps } from '@/composables/component'\nimport { makeDimensionProps, useDimension } from '@/composables/dimensions'\nimport { useToggleScope } from '@/composables/toggleScope'\nimport { makeVirtualProps, useVirtual } from '@/composables/virtual'\n\n// Utilities\nimport { onMounted, onScopeDispose, toRef } from 'vue'\nimport {\n  convertToUnit,\n  genericComponent,\n  getCurrentInstance,\n  getScrollParent,\n  propsFactory,\n  useRender,\n} from '@/util'\n\n// Types\nimport type { PropType, Ref } from 'vue'\nimport type { GenericProps } from '@/util'\n\nexport interface VVirtualScrollSlot<T> {\n  item: T\n  index: number\n}\n\nexport const makeVVirtualScrollProps = propsFactory({\n  items: {\n    type: Array as PropType<readonly unknown[]>,\n    default: () => ([]),\n  },\n  renderless: Boolean,\n\n  ...makeVirtualProps(),\n  ...makeComponentProps(),\n  ...makeDimensionProps(),\n}, 'VVirtualScroll')\n\nexport const VVirtualScroll = genericComponent<new <T, Renderless extends boolean = false>(\n  props: {\n    items?: readonly T[]\n    renderless?: Renderless\n  },\n  slots: {\n    default: VVirtualScrollSlot<T> & (Renderless extends true ? {\n      itemRef: Ref<HTMLElement | undefined>\n    } : {})\n  }\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VVirtualScroll',\n\n  props: makeVVirtualScrollProps(),\n\n  setup (props, { slots }) {\n    const vm = getCurrentInstance('VVirtualScroll')\n    const { dimensionStyles } = useDimension(props)\n    const {\n      calculateVisibleItems,\n      containerRef,\n      markerRef,\n      handleScroll,\n      handleScrollend,\n      handleItemResize,\n      scrollToIndex,\n      paddingTop,\n      paddingBottom,\n      computedItems,\n    } = useVirtual(props, toRef(props, 'items'))\n\n    useToggleScope(() => props.renderless, () => {\n      function handleListeners (add = false) {\n        const method = add ? 'addEventListener' : 'removeEventListener'\n\n        if (containerRef.value === document.documentElement) {\n          document[method]('scroll', handleScroll, { passive: true })\n          document[method]('scrollend', handleScrollend)\n        } else {\n          containerRef.value?.[method]('scroll', handleScroll, { passive: true })\n          containerRef.value?.[method]('scrollend', handleScrollend)\n        }\n      }\n\n      onMounted(() => {\n        containerRef.value = getScrollParent(vm.vnode.el as HTMLElement, true)\n        handleListeners(true)\n      })\n      onScopeDispose(handleListeners)\n    })\n\n    useRender(() => {\n      const children = computedItems.value.map(item => (\n        <VVirtualScrollItem\n          key={ item.key }\n          renderless={ props.renderless }\n          onUpdate:height={ height => handleItemResize(item.index, height) }\n        >\n          { slotProps => slots.default?.({ item: item.raw, index: item.index, ...slotProps }) }\n        </VVirtualScrollItem>\n      ))\n\n      return props.renderless ? (\n        <>\n          <div ref={ markerRef } class=\"v-virtual-scroll__spacer\" style={{ paddingTop: convertToUnit(paddingTop.value) }} />\n          { children }\n          <div class=\"v-virtual-scroll__spacer\" style={{ paddingBottom: convertToUnit(paddingBottom.value) }} />\n        </>\n      ) : (\n        <div\n          ref={ containerRef }\n          class={[\n            'v-virtual-scroll',\n            props.class,\n          ]}\n          onScrollPassive={ handleScroll }\n          onScrollend={ handleScrollend }\n          style={[\n            dimensionStyles.value,\n            props.style,\n          ]}\n        >\n          <div\n            ref={ markerRef }\n            class=\"v-virtual-scroll__container\"\n            style={{\n              paddingTop: convertToUnit(paddingTop.value),\n              paddingBottom: convertToUnit(paddingBottom.value),\n            }}\n          >\n            { children }\n          </div>\n        </div>\n      )\n    })\n\n    return {\n      calculateVisibleItems,\n      scrollToIndex,\n    }\n  },\n})\n\nexport type VVirtualScroll = InstanceType<typeof VVirtualScroll>\n"]},"metadata":{},"sourceType":"module"}