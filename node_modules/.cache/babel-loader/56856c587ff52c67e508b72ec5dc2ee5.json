{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.at.js\";\nimport \"core-js/modules/es.string.at-alternative.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.splice.js\";\n// Composables\nimport { useToggleScope } from \"./toggleScope.js\"; // Utilities\n\nimport { computed, inject, onScopeDispose, provide, reactive, readonly, shallowRef, toRaw, watchEffect } from 'vue';\nimport { getCurrentInstance } from \"../util/index.js\"; // Types\n\nvar StackSymbol = Symbol.for('vuetify:stack');\nvar globalStack = reactive([]);\nexport function useStack(isActive, zIndex, disableGlobalStack) {\n  var vm = getCurrentInstance('useStack');\n  var createStackEntry = !disableGlobalStack;\n  var parent = inject(StackSymbol, undefined);\n  var stack = reactive({\n    activeChildren: new Set()\n  });\n  provide(StackSymbol, stack);\n\n  var _zIndex = shallowRef(Number(zIndex.value));\n\n  useToggleScope(isActive, function () {\n    var _globalStack$at;\n\n    var lastZIndex = (_globalStack$at = globalStack.at(-1)) === null || _globalStack$at === void 0 ? void 0 : _globalStack$at[1];\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : Number(zIndex.value);\n\n    if (createStackEntry) {\n      globalStack.push([vm.uid, _zIndex.value]);\n    }\n\n    parent === null || parent === void 0 ? void 0 : parent.activeChildren.add(vm.uid);\n    onScopeDispose(function () {\n      if (createStackEntry) {\n        var idx = toRaw(globalStack).findIndex(function (v) {\n          return v[0] === vm.uid;\n        });\n        globalStack.splice(idx, 1);\n      }\n\n      parent === null || parent === void 0 ? void 0 : parent.activeChildren.delete(vm.uid);\n    });\n  });\n  var globalTop = shallowRef(true);\n\n  if (createStackEntry) {\n    watchEffect(function () {\n      var _globalStack$at2;\n\n      var _isTop = ((_globalStack$at2 = globalStack.at(-1)) === null || _globalStack$at2 === void 0 ? void 0 : _globalStack$at2[0]) === vm.uid;\n\n      setTimeout(function () {\n        return globalTop.value = _isTop;\n      });\n    });\n  }\n\n  var localTop = computed(function () {\n    return !stack.activeChildren.size;\n  });\n  return {\n    globalTop: readonly(globalTop),\n    localTop: localTop,\n    stackStyles: computed(function () {\n      return {\n        zIndex: _zIndex.value\n      };\n    })\n  };\n}","map":{"version":3,"mappings":"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","names":["useToggleScope","computed","inject","onScopeDispose","provide","reactive","readonly","shallowRef","toRaw","watchEffect","getCurrentInstance","StackSymbol","Symbol","for","globalStack","useStack","isActive","zIndex","disableGlobalStack","vm","createStackEntry","parent","undefined","stack","activeChildren","Set","_zIndex","Number","value","lastZIndex","at","push","uid","add","idx","findIndex","v","splice","delete","globalTop","_isTop","setTimeout","localTop","size","stackStyles"],"sources":["../../src/composables/stack.ts"],"sourcesContent":["// Composables\nimport { useToggleScope } from '@/composables/toggleScope'\n\n// Utilities\nimport { computed, inject, onScopeDispose, provide, reactive, readonly, shallowRef, toRaw, watchEffect } from 'vue'\nimport { getCurrentInstance } from '@/util'\n\n// Types\nimport type { InjectionKey, Ref } from 'vue'\n\nconst StackSymbol: InjectionKey<StackProvide> = Symbol.for('vuetify:stack')\n\ninterface StackProvide {\n  activeChildren: Set<number>\n}\n\nconst globalStack = reactive<[uid: number, zIndex: number][]>([])\n\nexport function useStack (\n  isActive: Readonly<Ref<boolean>>,\n  zIndex: Readonly<Ref<string | number>>,\n  disableGlobalStack: boolean\n) {\n  const vm = getCurrentInstance('useStack')\n  const createStackEntry = !disableGlobalStack\n\n  const parent = inject(StackSymbol, undefined)\n  const stack: StackProvide = reactive({\n    activeChildren: new Set<number>(),\n  })\n  provide(StackSymbol, stack)\n\n  const _zIndex = shallowRef(Number(zIndex.value))\n  useToggleScope(isActive, () => {\n    const lastZIndex = globalStack.at(-1)?.[1]\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : Number(zIndex.value)\n\n    if (createStackEntry) {\n      globalStack.push([vm.uid, _zIndex.value])\n    }\n\n    parent?.activeChildren.add(vm.uid)\n\n    onScopeDispose(() => {\n      if (createStackEntry) {\n        const idx = toRaw(globalStack).findIndex(v => v[0] === vm.uid)\n        globalStack.splice(idx, 1)\n      }\n\n      parent?.activeChildren.delete(vm.uid)\n    })\n  })\n\n  const globalTop = shallowRef(true)\n  if (createStackEntry) {\n    watchEffect(() => {\n      const _isTop = globalStack.at(-1)?.[0] === vm.uid\n      setTimeout(() => globalTop.value = _isTop)\n    })\n  }\n\n  const localTop = computed(() => !stack.activeChildren.size)\n\n  return {\n    globalTop: readonly(globalTop),\n    localTop,\n    stackStyles: computed(() => ({ zIndex: _zIndex.value })),\n  }\n}\n"]},"metadata":{},"sourceType":"module"}